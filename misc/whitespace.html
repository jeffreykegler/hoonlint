<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Hoon whitespace standards</title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<div id="header">
<h1 class="title">Hoon whitespace standards</h1>
</div>
<div id="TOC">
<ul>
<li><a href="#about-this-document">About this document</a></li>
<li><a href="#terminology">Terminology</a><ul>
<li><a href="#deontology">Deontology</a></li>
<li><a href="#hoon-source-files">Hoon source files</a></li>
<li><a href="#rows-silos-and-slots">Rows, silos and slots</a></li>
<li><a href="#characters-and-character-boundaries">Characters and character boundaries</a></li>
<li><a href="#blocks">Blocks</a></li>
<li><a href="#location-and-alignment">Location and alignment</a></li>
<li><a href="#hoon-statements">Hoon statements</a></li>
<li><a href="#runes">Runes</a></li>
<li><a href="#hoon-expressions">Hoon expressions</a></li>
<li><a href="#joined-and-split">Joined and split</a></li>
<li><a href="#pseudo-joins">Pseudo-joins</a></li>
<li><a href="#horizontal-multiline-and-vertical-separation">Horizontal, multiline and vertical separation</a></li>
<li><a href="#inter-line-alignment">Inter-line Alignment</a></li>
</ul></li>
<li><a href="#header-and-inline-comments">Header and inline comments</a><ul>
<li><a href="#staircase-comments">Staircase comments</a></li>
</ul></li>
<li><a href="#vertical-gaps">Vertical Gaps</a></li>
<li><a href="#types-of-tall-hoons">Types of tall hoons</a></li>
<li><a href="#top-level-whitespace">Top-level whitespace</a></li>
<li><a href="#backdenting">Backdenting</a><ul>
<li><a href="#backdenting-and-vertical-vertical-separation">Backdenting and vertical vertical separation</a></li>
<li><a href="#chaining-backdented-hoons">Chaining backdented hoons</a></li>
</ul></li>
<li><a href="#curried-backdenting">Curried backdenting</a><ul>
<li><a href="#first-example">First example</a></li>
<li><a href="#second-example">Second example</a></li>
</ul></li>
<li><a href="#split-hints">Split hints</a></li>
<li><a href="#running-hoons">Running hoons</a><ul>
<li><a href="#runnings">Runnings</a><ul>
<li><a href="#runstep-inter-line-alignment">Runstep inter-line alignment</a></li>
<li><a href="#running-inherited-inter-line-alignment">Running-inherited inter-line alignment</a></li>
<li><a href="#mixed-inter-line-alignments-in-a-running">Mixed inter-line alignments in a running</a></li>
</ul></li>
</ul></li>
<li><a href="#jogging-hoons">Jogging hoons</a><ul>
<li><a href="#joggings">Joggings</a><ul>
<li><a href="#chess-sidedness">Chess-sidedness</a></li>
</ul></li>
<li><a href="#jogs">Jogs</a><ul>
<li><a href="#joined-jogs">Joined jogs</a></li>
<li><a href="#split-jogs">Split jogs</a></li>
</ul></li>
<li><a href="#jogging-terminator">Jogging terminator</a></li>
</ul></li>
<li><a href="#batteries">Batteries</a></li>
<li><a href="#criss-cross-lines">Criss-cross lines</a></li>
<li><a href="#sail">Sail</a><ul>
<li><a href="#sail-1-fixed-runes">Sail 1-fixed runes</a></li>
<li><a href="#semtis">SEMTIS</a></li>
<li><a href="#tagged-sail-statements">Tagged sail statements</a></li>
<li><a href="#sail-attributes">Sail attributes</a></li>
</ul></li>
<li><a href="#selgap">SELGAP</a></li>
<li><a href="#details">Details</a><ul>
<li><a href="#currying-basic-syntax-hoons">Currying basic syntax hoons</a></li>
<li><a href="#running-hoons-1">Running hoons</a></li>
<li><a href="#running-hoons-2">0-running hoons</a><ul>
<li><a href="#joined-0-running-hoons">Joined 0-running hoons</a></li>
<li><a href="#split-0-running-hoons">Split 0-running hoons</a></li>
</ul></li>
<li><a href="#running-hoons-3">1-running hoons</a><ul>
<li><a href="#joined-1-running-hoons">Joined 1-running hoons</a></li>
<li><a href="#split-1-running-hoons">Split 1-running hoons</a></li>
</ul></li>
<li><a href="#jogging-hoons-1">Jogging hoons</a></li>
<li><a href="#jogging-hoons-2">1-jogging hoons</a><ul>
<li><a href="#kingside-1-jogging-hoons">Kingside 1-jogging hoons</a></li>
<li><a href="#queenside-1-jogging-hoons">Queenside 1-jogging hoons</a></li>
</ul></li>
<li><a href="#jogging-hoons-3">2-jogging hoons</a><ul>
<li><a href="#kingside-head-joined-2-jogging-hoons">Kingside head-joined 2-jogging hoons</a></li>
<li><a href="#kingside-head-split-2-jogging-hoons">Kingside head-split 2-jogging hoons</a></li>
<li><a href="#queenside-head-joined-2-jogging-hoons">Queenside head-joined 2-jogging hoons</a></li>
<li><a href="#queenside-head-split-2-jogging-hoons">Queenside head-split 2-jogging hoons</a></li>
</ul></li>
<li><a href="#jogging-1-hoons">Jogging-1 hoons</a></li>
<li><a href="#sigcen">SIGCEN</a></li>
<li><a href="#battery-hoons">Battery hoons</a><ul>
<li><a href="#battery-arm-currying">Battery arm currying</a></li>
<li><a href="#barcen">BARCEN</a></li>
<li><a href="#barcab">BARCAB</a></li>
<li><a href="#barket">BARKET</a></li>
</ul></li>
<li><a href="#ford-hoons">Ford hoons</a><ul>
<li><a href="#ford-1-hoons">Ford-1 hoons</a></li>
<li><a href="#ford-hoof-hoons">Ford hoof hoons</a></li>
<li><a href="#sequence-ford-hoons">0-sequence Ford hoons</a></li>
<li><a href="#ford-hoon-sequence">Ford hoon sequence</a></li>
<li><a href="#ford-2-hoons">Ford-2 hoons</a></li>
<li><a href="#fascom">FASCOM</a></li>
<li><a href="#fastis">FASTIS</a></li>
</ul></li>
</ul></li>
<li><a href="#appendix-non-standard-code">Appendix: Non-standard code</a><ul>
<li><a href="#chess-sidedness-1">Chess-sidedness</a></li>
<li><a href="#jogging-body-column">Jogging body column</a></li>
<li><a href="#inter-line-alignment-1">Inter-line alignment</a></li>
</ul></li>
<li><a href="#appendix-formal-definition-of-vertical-gap-body">Appendix: Formal definition of &quot;vertical gap body&quot;</a></li>
<li><a href="#appendix-futures">Appendix: Futures</a><ul>
<li><a href="#eliminate-the-details">Eliminate the details</a></li>
<li><a href="#free-currying">&quot;Free&quot; currying</a></li>
<li><a href="#post-comments">Post-comments</a></li>
</ul></li>
</ul>
</div>
<h1 id="about-this-document">About this document</h1>
<p>This document specifies a convention for the use of whitespace by Hoon to the level and to the degree of precision necessary for <code>hoonfmt</code> and <code>hoonlint</code>. This document only deals with conventions for Hoon expressions that contain gaps. These are</p>
<ul>
<li><p>tall Hoon expressions; and</p></li>
<li><p>SELGAP, a special case.</p></li>
</ul>
<p>Whitespace in other Hoon expressions is always an &quot;ace&quot; -- a single space. For Hoon expressions in which all whitespace is an ace, there is no latitude in the use of whitespace, and therefore no need for any conventions.</p>
<h1 id="terminology">Terminology</h1>
<h2 id="deontology">Deontology</h2>
<p>In this document, we say &quot;<code>X</code> should be <code>Y</code>&quot;, if <code>X</code> must be <code>Y</code> in order to meet the standard described in this document. Code or practices that obey this standard we will call <strong>standard</strong>. Code or practices that are not standard we will call <strong>non-standard</strong>. One pragmatic consequence of non-standard code is that it may draw warnings from <code>hoonlint</code>.</p>
<p>In this document, we say &quot;<code>X</code> must be <code>Y</code>&quot;, if <code>X</code> must be <code>Y</code> in both standard and non-standard code. This would be the case, for example, if X is Y as a matter of definition; if X is Y due to a logical or a mathematical equivalence; or if the Hoon syntax requires that X be Y.</p>
<h2 id="hoon-source-files">Hoon source files</h2>
<p>This document applies to Hoon source files. A Hoon source file is divided into newline-terminated lines each of which contains 1 or more characters. The 1-based offset of a character in its line is its <strong>column location</strong>. The 1-based line number of a character is its <strong>line location</strong>. Line location is often abbreviated to <strong>line</strong>, and column location is often abbreviated to <strong>column</strong>.</p>
<p>To avoid confusion, in this document &quot;column&quot; is always used to mean the column location of a character within a line, as defined above. When we discuss other 2-dimensional grids, we use the terms &quot;row&quot; for position on the vertical axis, and &quot;silo&quot; for position on the horizontal axis.</p>
<h2 id="rows-silos-and-slots">Rows, silos and slots</h2>
<p>A row-silo grid is a 2-dimensional grid of <strong>slots</strong>, where a row is a sequence of slots which share the same position on the vertical axis, and a silo is a sequence of slots which share the same position on the horizontal axis. For orthogonality with columns and lines, row and silo numbers are 1-based. There will be several definitions of &quot;row&quot; and &quot;silo&quot;, and we will give specifics in the context where they are used.</p>
<p>When, for a given row, we say that &quot;sequence <code>S[0], S[1] ... S[n]</code> is <strong>slotted</strong> beginning at slot <code>x</code>&quot;, we mean that, for <code>0 &lt;= i &lt;= n</code>, <code>S[i]</code> goes into slot <code>i+x</code>. When, for a given row, we say that &quot;sequence <code>S[0], S[1] ... S[n]</code> is <strong>slotted</strong>&quot;, we mean that &quot;sequence <code>S[0], S[1] ... S[n]</code> is <strong>slotted</strong> beginning at slot 1&quot;,</p>
<h2 id="characters-and-character-boundaries">Characters and character boundaries</h2>
<p>A <strong>whitespace character</strong> is either an ASCII space or a newline. A <strong>whitespace boundary</strong> is one of the following:</p>
<ul>
<li><p>The start of the Hoon source file.</p></li>
<li><p>The end of the Hoon source file.</p></li>
<li><p>A location between a whitespace character and a non-whitespace character.</p></li>
</ul>
<p>Note that a whitespace boundary is not a column location. Instead it is a location immediately before a column location; immediately after a column location; or both.</p>
<h2 id="blocks">Blocks</h2>
<p>A character block is a lexically contiguous sequence of one or more characters. A whitespace block is a character block that contains only whitespace characters and occurs between two whitespace boundaries. An <strong>ace</strong> is a whitespace block that contains a single ASCII space. A <strong>gap</strong> is any whitespace block that is not an ace.</p>
<p>A <strong>flat gap</strong> is a gap that contains only ASCII spaces. A <strong>multiline gap</strong> is a gap that contains at least one newline. All gaps are either flat or multiline.</p>
<p>A <strong>text block</strong> is a character block</p>
<ul>
<li><p>that begins at a whitespace boundary;</p></li>
<li><p>whose first character is a non-whitespace character;</p></li>
<li><p>that ends at a whitespace boundary; and</p></li>
<li><p>whose last character is a non-whitespace character.</p></li>
</ul>
<p>Note that text blocks may contain whitespace characters. We often refer to a text block simply as a <strong>text</strong>.</p>
<h2 id="location-and-alignment">Location and alignment</h2>
<p>The column location at which <code>x</code> starts will sometimes be written as <code>Column(x)</code>, where <code>x</code> designates some text in a Hoon source file. The line location at which <code>x</code> starts will sometimes be written as <code>Line(x)</code>. When we say &quot;the column location of <code>x</code>&quot;, we mean <code>Column(x)</code>.</p>
<p>We say &quot;column <code>C</code> is aligned <code>N</code> characters after column <code>D</code>&quot; if and only if <code>C = D + N</code>. We say &quot;column <code>C</code> is aligned at column <code>D</code>&quot; if and only if <code>C = D</code>. We say &quot;column <code>C</code> is aligned <code>N</code> characters before column <code>D</code>&quot; if and only if <code>C = D - N</code>.</p>
<p>When we speak of text blocks being aligned relative to columns or relative to other text blocks, we are refering to the column location of the text blocks. For example, if we say &quot;text X is aligned N characters after text Y&quot;, we mean that <code>Column(X) = Column(Y) + N</code>.</p>
<p>Often we express distance between columns in stops instead of characters. A <strong>stop</strong> is two characters.</p>
<p>Let <em>T1</em> and <em>T2</em> be two text blocks on the same line. We say that <em>T2</em> is <strong>tightly separated</strong>, if and only if</p>
<ul>
<li><p><em>T1</em> is separated from <em>T2</em> by a one-stop flat gap, and</p></li>
<li><p><em>T1</em> precedes <em>T2</em>.</p></li>
</ul>
<p>If a text block is <strong>tightly separated</strong>, we also say that it is <strong>tightly aligned</strong>. Note that, by this definition, the first text block on a line can never be tightly aligned.</p>
<p>Many alignments are with respect to an <strong>anchor column</strong>. In the context of a specific Hoon statement, <strong>h</strong>, the anchor column typically is <code>Column(Rune(h))</code>. But if the rune of <strong>h</strong> is part of a non-trivial curried text block, as described below, the anchor column of <strong>h</strong> may be aligned at a different rune.</p>
<h2 id="hoon-statements">Hoon statements</h2>
<p>A Hoon source file contains one or more Hoon <strong>statements</strong>. The Hoon statements are separated by whitespace. Optionally, the first Hoon statement may be preceded by whitespace. Also optionally, the last Hoon statement may be followed by whitespace.</p>
<p>A Hoon <strong>statement</strong> is a text block which compiles to a single AST node. We sometimes refer to a Hoon statement as a &quot;hoon&quot;, but strictly speaking, the &quot;Hoon statement&quot; is the text block before parsing, and the &quot;hoon&quot; is the AST produced by parsing.</p>
<h2 id="runes">Runes</h2>
<p>In this document, <strong>rune</strong> is used in a somewhat different sense than in most Hoon documents. In most Hoon documents, &quot;rune&quot; means a digraph which acts as the keyword at the beginning of a Hoon statement. In this document, we will refer to those as &quot;statement runes&quot;.</p>
<p>In this document, &quot;rune&quot; will mean either</p>
<ul>
<li><p>a statement rune; or</p></li>
<li><p>an arm marker digraph: one of LUSLUS (<code>++</code>), LUSHEP (<code>+-</code>), or LUSTIS (<code>+=</code>).</p></li>
</ul>
<p>Note that not all special-character digraphs are runes. In this document, HEPHEP (<code>--</code>) or TISTIS (<code>==</code>) will be called <strong>boundary digraphs</strong>, and in this document they are not considered runes. When context makes the meaning clear, a boundary digraph is usually called simply a <strong>boundary</strong>.</p>
<p>Comment-marking digraphs, such as <code>::</code>, are also not considered runes. Comments, including the digraphs that begin them, are considered whitespace, and nothing in whitespace is considered a rune.</p>
<h2 id="hoon-expressions">Hoon expressions</h2>
<p>A tall <strong>rune expression</strong> is a tall Hoon expression whose &quot;keyword&quot; is a rune. A tall rune expression consists of the initial rune followed by zero or more subexpressions, called <strong>runechildren</strong>.</p>
<p>The <strong>arity</strong> of a rune expression is the number of its runechildren. In the tall Hoon expressions which are the focus in this document, the rune is separated from its first runechild, and consecutive runechildren are separated from each other, by gaps.</p>
<p>Let <code>r</code> be the rune digraph of a rune expression. The <strong>rune line</strong> of <code>r</code> is <code>Line(r)</code>. The <strong>rune column</strong> of <code>r</code> is <code>Column(r)</code>.</p>
<p>Let <code>r</code> be a rune. We sometimes write the Hoon expression that begins with <code>r</code> as <code>Hoon(r)</code>. If <code>h</code> is a Hoon, we can write its rune as <code>Rune(h)</code>. This implies that</p>
<pre><code>   Line(Hoon(r)) == Line(r)
   Column(Hoon(r)) == Column(r)</code></pre>
<p>Let <code>h</code> be a rune expression. We sometimes write the Hoon expression that is the syntactic parent of <code>h</code> as <code>Parent(h)</code>.</p>
<p>Let <em>H</em> be a text block which is a Hoon statement, and let <em>T1</em> be a text block. <em>H</em> <strong>properly contains</strong> <em>T1</em> if <em>H</em> contains <em>T1</em>, but <em>H</em> is not identical to <em>T1</em>. <em>H</em> <strong>directly contains</strong> <em>T1</em> if <em>H</em> properly contains <em>T1</em> and no other properly contained Hoon statement of <em>H</em> properly contains <em>T1</em>.</p>
<h2 id="joined-and-split">Joined and split</h2>
<p>For many Hoon statements, the pattern of the standard whitespace conventions depends on whether a specific gap in that Hoon statement is horizontal or vertical. A flat gap is always considered horizontal, and a vertical gap is always multiline. But, because of pseudo-joins, a multiline gap is not necessarily a vertical gap. Pseudo-joins are defined below.</p>
<p>If the pattern-decisive gap is horizontal, the conventions for the hoon which directly contains that gap follow a &quot;joined&quot; pattern. If the pattern-decisive gap is vertical, the conventions for the hoon which directly contains that gap follow a &quot;split&quot; pattern. The specific conventions will be specified below, with each syntax.</p>
<h2 id="pseudo-joins">Pseudo-joins</h2>
<p>It is sometimes convenient to have a multiline pattern-decisive gap, but to otherwise follow the &quot;joined&quot; syntax pattern. For this, it useful to have a form of multiline gap which is treated as a horizontal gap.</p>
<p>This is useful, for example, when the programmer finds &quot;joined&quot; syntax appropriate, but wants to include a comment in the pattern-decisive gap. A multiline gap that is treated as if it were a horizontal gap is called a <strong>pseudo-join</strong>.</p>
<p><em>From <code>app/talk.hoon</code>, lines 24-33</em>:</p>
<pre><code>=&gt;  :&gt;  #
    :&gt;  #  %arch
    :&gt;  #
    :&gt;    data structures
    ::
    |%
    ++  state                                           :&gt;  application state
      $:  ::  messaging state                           ::
          grams/(list telegram)                         :&lt;  all history
          known/(map serial @ud)                        :&lt;  messages heard</code></pre>
<p>The above example contains two pseudo-joins. The first pseudo-join runs from line 24 to line 29. The second pseudo-join runs from line 31 to line 32.</p>
<p>Let <code>J</code> be a <strong>join column</strong>. A multiline text is a <strong>pseudo-join</strong> at <code>J</code> if and only if every line of it, except the last line, has a comment aligned at <code>J</code>. This implies that the first, partial, line of the pseudo-join must contain a comment aligned at <code>J</code>.</p>
<p>Visually, the pseudo-join's comments look like &quot;place holders&quot; for the text that follows the pseudo-join.</p>
<p>Intuitively, a pseudo-join is said to be <strong>equivalent</strong> to a flat gap if the text that follows both of them is aligned at the same column location. More formally, Let <code>file1</code> be a Hoon source file. Let <code>J</code> be the join column of a pseudo-join in <code>file1</code>. Construct another Hoon source file, <code>file2</code>, by lexically replacing the pseudo-join with a flat gap. Call that flat gap, <code>G</code>. Let <code>H</code> be the column location immediately after <code>G</code> in <code>file2</code>. The pseudo-join and the flat gap are <strong>equivalent</strong> if and only if <code>J == H</code>.</p>
<h2 id="horizontal-multiline-and-vertical-separation">Horizontal, multiline and vertical separation</h2>
<p>If a flat gap is allowed according to these conventions, it is a <strong>comformant</strong> flat gap. If the gap immediately preceding a text block is a pseudo-join equivalent to a comformant flat gap, the text block is <strong>pseudo-joined</strong>.</p>
<p>If the gap immediately preceding a text block is flat or a pseudo-join, the text block is <strong>horizontally separated</strong>. If a text block is not horizontally separated, then it is <strong>vertically separated</strong>.</p>
<h2 id="inter-line-alignment">Inter-line Alignment</h2>
<p>Inter-line alignment aligns a text block with one or more text blocks on &quot;associated&quot; lines. There are several different kinds of inter-line alignment, and each differs in its definition of which text blocks should be aligned with which, and which lines it &quot;associates&quot; with the current line. The specific definitions of inter-line alignment will be described in detail in the sections to follow.</p>
<h1 id="header-and-inline-comments">Header and inline comments</h1>
<p>Comments count as whitespace. A comment is a <strong>header comment</strong> if it is on a line by itself. If a comment is not a header comment, it is a <strong>rightside</strong> comment. A rightside comment is a <strong>margin comment</strong> if it begins at or after column 57, or immediately after a sequence of 20 or more ASCII spaces. All margin comments should start at column 57. A rightside comment is an <strong>inline comment</strong> if it is not a margin comment.</p>
<p>In standard code, header comments are</p>
<ul>
<li><p>pre-comments or inter-comments, as determined by their hoon;</p></li>
<li><p>part of a staircase; or</p></li>
<li><p>meta-comments.</p></li>
</ul>
<p>We say that a comment belongs to a hoon if that hoon directly contains the gap that lexically contains that comment. We say a hoon is the hoon of a comment if the comment belongs to that hoon.</p>
<p>Meta-comments start at column 1. Depending on their hoon, inter-comments may also start at column 1. When inter-comments start at column 1, only the programmer's intent determines whether a given header comment is an inter-comment or a meta-comment.</p>
<p>Pre-comments, inter-comments and staircases are structural comments. The contents of structural comments wll typically be appropriate for the syntactic context of the code in which the structural comment occurs.</p>
<p>Meta-comments are not structural comments, and their content may be anything. A frequent use for meta-comments is to &quot;comment out&quot; Hoon code.</p>
<h2 id="staircase-comments">Staircase comments</h2>
<p>Informally, staircase comments take the form</p>
<pre><code>::
::
::::
  ::
  ::</code></pre>
<p>More formally, a staircase comment consists of an <strong>upper riser</strong>, a <strong>tread</strong>, and a <strong>lower riser</strong>. The upper riser is a sequence of normal comment lines, aligned at the inter-comment column. (The inter-comment column location varies, depending on the syntax which contains the comment.) The tread is four colons, aligned at the inter-comment column and followed by a whitespace character. The lower riser is a sequence of normal comment lines, aligned at the column one stop greater than the inter-comment column. A still more formal definition of a staircase is given in an appendix.</p>
<h1 id="vertical-gaps">Vertical Gaps</h1>
<p>When we state that a vertical gap has <strong>comments at location A</strong>, we mean that the gap's inter-comment column location is the stated column location, and that the gap's pre-comment column location is not defined. When we state that a vertical gap has <strong>comments at location A as well as location B</strong>, we mean that the gap's inter-comment column location is location A, and that the gap's pre-comment column location is location B.</p>
<p>For example, when we write</p>
<blockquote>
<p>A vertical gap, with comments at the anchor column as well as the jog base column</p>
</blockquote>
<p>we mean that the inter-comment location of the vertical gap is the anchor column, and the pre-comment location is the &quot;jog base column&quot;. If instead we write</p>
<blockquote>
<p>A vertical gap, with comments at the anchor column.</p>
</blockquote>
<p>then we mean that the inter-comment location of the vertical gap is the anchor column, and the pre-comment location is not defined.</p>
<p>In describing a vertical gap's comment locations, we may specify them explicitly as column locations, or implicitly, as alignments with a text block. If column location is expressed implicitly via a text block, the implicit location is the start column location of the text block.</p>
<p>A vertical gap contains, in lexical order,</p>
<ul>
<li><p>A newline-terminated partial line preamble. This preamble may be of length 1 -- that is, it may be just the newline character.</p></li>
<li><p>A body of zero or more full newline-terminated lines, all of them header comments or (in the case of non-standard code) blank lines.</p></li>
<li><p>A partial line postamble. This is never newline-terminated, and may be zero-length.</p></li>
</ul>
<p>Informally, the body of a standard vertical gap follows these conventions:</p>
<ul>
<li><p>A vertical gap may contain an &quot;inter-part&quot;, a &quot;pre-part&quot;, or both.</p></li>
<li><p>If both an inter-part and a pre-part are present, the inter-part must precede the pre-part.</p></li>
<li><p>The inter-part is a non-empty sequence of inter-comments and staircases.</p></li>
<li><p>A pre-part is a non-empty sequence of pre-comments.</p></li>
<li><p>Meta-comments may be inserted anywhere in, before, or after, either the pre-part or the inter-part.</p></li>
<li><p>A comment is not regarded as a meta-comment if it can be parsed as structural comment.</p></li>
</ul>
<p>A formal description of the vertical gap body is given in an appendix.</p>
<h1 id="types-of-tall-hoons">Types of tall hoons</h1>
<p>Every tall hoon falls into one of 8 disjoint classes: running, jogging, battery, irregular, Ford, Sail, Udon and basic syntax.</p>
<ul>
<li><p>A tall hoon is a <strong>running hoon</strong> if it contains a runechild that uses the running syntax.</p></li>
<li><p>A tall hoon is a <strong>jogging hoon</strong> if it contains a runechild that uses the jogging syntax.</p></li>
<li><p>A tall hoon is a <strong>battery hoon</strong> if it contains a runechild that uses the battery syntax.</p></li>
<li><p>SELGAP is the only tall <strong>irregular hoon</strong>. (Most irregular hoons do not contain a gap.)</p></li>
<li><p>Ford statements have a specialized syntax, as described under &quot;Details&quot;.</p></li>
<li><p>Sail statements have a specialized syntax, as described below.</p></li>
<li><p>Udon (Unmarkdown) Hoon statements have a specialized syntax. The whitespace convention of this document allows Udon statements, but does impose any restrictions on their whitespace format.</p></li>
<li><p>A tall hoon is a <strong>basic syntax hoon</strong> if it does not fall into any of the above, more complex, classes.</p></li>
</ul>
<h1 id="top-level-whitespace">Top-level whitespace</h1>
<p>We call a Hoon statement not contained by another Hoon statement, a <strong>top-level</strong> Hoon statement. A Hoon source file is a sequence of top-level Hoon statements. All top-level Hoon statements should start at column 1. Successive top-level Hoon statements should be separated by a vertical gap with comments at column location 1.</p>
<p>The first top-level Hoon statement may be preceded by a vertical gap, called the <strong>top-level leader</strong>. Comments in the top-level leader should be at column location 1. The top-level leader is a special-case of a vertical gap -- it contains a body and a zero-length postamble, but no preamble.</p>
<p>The last top-level Hoon statement may be followed by a vertical gap, called the <strong>top-level trailer</strong>. Comments in the top-level trailer should be at column location 1. The top-level trailer is a special-case of a vertical gap -- it contains a body and a preamble, but no postamble.</p>
<h1 id="backdenting">Backdenting</h1>
<p>The flagship Hoon whitespace strategy is backdenting. Variations on the idea of backdenting appear throughout, but the archetypal case of backdenting is its use in basic syntax hoons. Here is a example of a 4-ary hoon:</p>
<p><em>From <code>arvo/sys/hoon.hoon</code>, 6752-6755:</em></p>
<pre><code>        :^    %wtcl
            [%dtts [%rock %$ |] [%$ axe]]
          [%rock %f |]
        [%rock %f &amp;]
</code></pre>
<p>A basic syntax hoon of arity 3 or more should be joined. A basic syntax hoon of arity 2 or less should be split.</p>
<p>The first runechild of a joined basic syntax hoon should be on the same line as the rune, separated by a horizontal gap. The first runechild may be tightly aligned, or aligned at the backdent column. Subsequent runechildren of a joined basic syntax hoon should be tightly aligned with the previous runechild, or separated from the previous runechild by a vertical gap.</p>
<p>The first runechild of a split basic syntax hoon should be vertically separated. Subsequent runechildren of a joined basic syntax hoon should be tightly aligned with the previous runechild, or vertically separated.</p>
<h2 id="backdenting-and-vertical-vertical-separation">Backdenting and vertical vertical separation</h2>
<p>In a basic syntax <code>n</code>-arity hoon, a vertically separated <code>m</code>'th runechild should be aligned <code>n-m</code> stops after than the anchor column. Here <code>m</code> is 1-based, so that the 1'th runechild is the first runechild, the 2'th runechild is the second runechild, etc.</p>
<p>For example, in an 3-runechild hoon, a vertically separated first runechild should be aligned 2 stops after than the anchor column; a vertically separated second runechild should be aligned 1 stop after than the anchor column; and a vertically separated third runechild be aligned at the anchor column.</p>
<p>This implies that, regardless of the number of runechildren in a backdented hoon, a vertically separated last runechild should be aligned at the anchor column. In the vertical gaps that belong directly to backdented hoons, comments should be aligned with the runechild immediately following the gap.</p>
<h2 id="chaining-backdented-hoons">Chaining backdented hoons</h2>
<p>As a special case, a runechild of an backdented hoon may have an inter-line alignment, based on its <strong>silo</strong> and <strong>chain</strong>. Intuitively, if two runechildren are in the same silo of the same chain, they should have the same inter-line alignment.</p>
<p><em>From <code>arvo/sys/zuse.hoon</code>, lines 2950-2959:</em></p>
<pre><code>     ::
     ::  make acru cores
     ::
     =/  ali      (pit:nu:crub 512 (shaz &#39;Alice&#39;))
     =/  ali-pub  (com:nu:crub pub:ex.ali)
     =/  bob      (pit:nu:crub 512 (shaz &#39;Robert&#39;))
     =/  bob-pub  (com:nu:crub pub:ex.bob)
     ::
     ::  alice signs and encrypts a symmetric key to bob
     ::</code></pre>
<p>More formally, a chain is a sequence of backdented hoons that obeys the following rules:</p>
<ul>
<li><p>Every hoon except the first is the last runechild of the previous hoon in the sequence.</p></li>
<li><p>Every tall rune is either</p>
<ul>
<li><p>a &quot;row-initial&quot; tall rune, which should be aligned at the first hoon in the sequence, or;</p></li>
<li><p>a &quot;joined&quot; tall rune, that is, another tall rune on the same line as an initial rune.</p></li>
</ul></li>
<li><p>The sequence is maximal. That is, a sequence is not considered a chain if it is a sub-sequence of a longer chain.</p></li>
</ul>
<p>For the purposes of chain inter-line alignment, we define row and silo as follows: Each row-initial rune starts a new row. For each row, the tall runes and their runechildren on the initial rune's line, taken in lexical order and recursively, are slotted.</p>
<p>Unless it is a 1-ary rune, a tall rune expression is never a silo element. Hoon statements of arity greater than 1 must be broken out into its statement rune and its runechildren, before being slotted. A row may contain multiple lines, but runes and runechildren not on the first line of the row are not slotted and therefore are not used in determining inter-line alignment.</p>
<p>This implies that, in the first line of a row</p>
<ul>
<li><p>Every row-initial rune is in slot 0,</p></li>
<li><p>Every statement rune is in its own slot.</p></li>
<li><p>Every runechild of a tall rune is in its own slot, unless that runechild is itself a non-unary tall rune expression.</p></li>
</ul>
<p>Further,</p>
<ul>
<li><p>For chained inter-line alignment, the row and silo grid may be &quot;ragged&quot;, so that some rows do not have elements in every slot.</p></li>
<li><p>A slot with no element is called &quot;empty&quot;. In a given row, a non-empty slot cannot follow an empty slot. In other words, all the empty slots must be at the end of a row.</p></li>
<li><p>Every row in a chain starts with a rune, but not every rune starts a new row.</p></li>
<li><p>A silo may be &quot;mixes&quot;, containing both runes and runechildren.</p></li>
</ul>
<p><em>From <code>arvo/sys/hoon.hoon</code>, lines 1572-1575:</em></p>
<pre><code>    =|  b/(set _?&gt;(?=(^ a) p.n.a))
    |-  ^+  b
    ?~  a   b
    $(a r.a, b $(a l.a, b (~(put in b) p.n.a)))</code></pre>
<p>In the above example, the chain contains 3 rows. (The 3rd row is multiline -- it contains the 3rd and 4th lines.) There are 3 silos and therefore 3 slots in every row. The 2nd silo is mixed -- it contains a rune (at row 2) as well as runechildren (at rows 1 and 3).</p>
<p>The 3rd slot of the 1st row is empty, so the slotting is &quot;ragged&quot;. All 3 rows have non-empty 1st and 2nd slots.</p>
<p>In all 3 rows, the 2nd slot is tightly aligned, The 3rd slot in the 2nd row is also tightly aligned.</p>
<p>Only one non-empty slot is not tightly aligned. The 3rd slot of the 3rd row is inter-line aligned. The <code>b</code> in the 3rd row comes after a gap of 3 spaces, but this follows the standard set forth in this document because it aligns with the <code>b</code> of the 2nd row, at column location 13.</p>
<p>Note that the 2nd row is an example of a &quot;joined&quot; hoon. The 2nd row contains two runes -- both the 1st and 2nd slots of the 2nd row are runes. In a chained hoon sequence, when a row starts with a unary rune, joined hoons can be convenient.</p>
<h1 id="curried-backdenting">Curried backdenting</h1>
<p>Curried backdenting is a method of conserving indentation. Curried backdenting treats a <strong>curried text block</strong> as a single rune for backdenting purposes. A curried text block must start with a rune, and must end with a rune on the same line. This implies that a curried text block cannot contain a multiline gap.</p>
<p>A curried text block is also called a <strong>currying</strong>. When a rune is in a currying, its anchor column is based on the first rune of the curried text block, and this may involve changing the anchor column of some of the runes in the currying. This shift of the anchor column is called <strong>reanchoring</strong>.</p>
<p>We call the last rune in a currying, the <strong>source rune</strong> or the <strong>reanchored rune</strong> of the currying. We call the first rune of the curried text block, its <strong>target rune</strong>, or the <strong>anchor rune</strong> of the currying.</p>
<p>Pedantically, every rune is in a curried text block, but most curryings are <strong>trivial</strong> -- they consist only of a single rune. In a trivial currying the reanchored rune is the same as the anchor rune or, to put the same thing in different words, and the source rune is the same as the target rune.</p>
<p>Not all pairings of source and target rune are allowed. If a currying whose source is rune <code>S</code> and whose target is rune <code>T</code> is allowed, we say the <strong>rune S curries with rune T</strong>. Trivial curryings are always allowed. Which rune is allowed to pair with which other runes in a non-trivial curryings is described in &quot;Details&quot;.</p>
<p>The runechildren of a currying are backdenting according to the standard rules for backdenting. The anchor column of a currying is the column location of the anchor rune. The arity of a currying is the sum of the arites of the curried runes, less the number of runechildren in the currying.</p>
<p>Since backdenting follows the same rules for curried hoons as for ordinary hoons, backdenting a trivial currying is equivalent to backdenting its rune. However, non-trivial currying will change the anchor column.</p>
<h2 id="first-example">First example</h2>
<p><em>From <code>arvo/sys/vane/ford.hoon</code>, lines 1916-1920:</em></p>
<pre><code>        :+  %depends  %|  :~
          definitions+[%&amp; deh]
          listeners+[%&amp; sup]
          waiting+[%&amp; out]
        ==</code></pre>
<p>The currying is on the line 1916, and contains two runes: COLSIG (<code>:~</code>) is the source and COLLUS (<code>:+</code>) is the target. The arity of COLSIG is 1 and the arity of COLLUS is 3. The currying contains 3 runechildren, so the currying is 1-arity: <code>(1 + 3) - 3 = 1</code>.</p>
<p>The anchor rune is the COLLUS (<code>:+</code>) at column 9, so the anchor column of the currying is column 9. COLSIG is 0-running, so the running is its first and only child. Normal backdenting aligns the 1st runechild of a 1-arity hoon at the anchor column (column 9). As we will see when we deal with runnings, the runsteps should be aligned one stop after running, which means they are at column 11 (<code>11 = 9 + 2</code>). The final TISTIS of running should be aligned at the anchor column (column 9). These alignments are what we see in the display above.</p>
<h2 id="second-example">Second example</h2>
<p><em>From <code>arvo/lib/hood/kiln.hoon</code>, lines 346-356:</em></p>
<pre><code>    =/  request-data  :~
        [0 [0 8.080] 0 &#39;localhost&#39; ~]
        ::  associate 0 as the anonymous ship, which is the ++add result.
        [[0 (scot %p (add our ^~((bex 64))))] ~ ~]
        &#39;not-yet-implemented&#39;
        `&#39;en-US,en;q=0.9&#39;
        `.127.0.0.1
      ==
    =/  monies/coin  [%many ~[[%blob request-data] [%$ ~.n 0]]]
    =/  request/silk:ford  [%bake %urb monies [our %home [%da now]] /web]
    (emit `card`[%exec /kiln/prime/cache our `[[our %home [%da now]] request]])</code></pre>
<p>The currying is line 346, the source rune is again COLSIG, and the target rune is TISFAS (<code>=/</code>). TISFAS is 3-fixed, and 2 of its runechildren are on the rune line. COLSIG is 1-arity, and its runechild is not on the rune line. The currying therefore contains a total of 2 runechildren.</p>
<p>Calculating the arity of the currying we have 3 (the arity of TISFAS) plus 1 (the arity of COLSIG) less 2 (the count of runechildren in the currying). Therefore the currying is 2-arity: <code>2 = (3+1)-(2)</code>.</p>
<p>The running of COLSIG is the first runechild of a 2-arity (curried) hoon, and therefore by the standard backdenting rules should be aligned at column 7, one stop after the anchor column (column 5). The runsteps are aligned one stop after the running, which is column 9 (<code>9=7+2</code>). The TISTIS of the running is aligned with the running, and therefore is at column 7.</p>
<p>The last child of the TISFAS is on line 354. It is the 2nd child of the 2-arity currying and therefore, by the standard backdenting rules, is aligned at the anchor column (column 5).</p>
<h1 id="split-hints">Split hints</h1>
<p><em>From <code>sys/vane/clay.hoon</code>, lines 4022-4228:</em></p>
<pre><code>    ~&gt;  %slog.
        :^  0  %rose  [&quot; &quot; &quot;[&quot; &quot;]&quot;]
        :^    leaf+&quot;initial merge failed&quot;
            leaf+&quot;my most sincere apologies&quot;
          &gt;p.p.p.+.q.hin&lt;
        q.p.p.+.q.hin
    [~ ..^$]</code></pre>
<p>The first runechild of SIGGAL (<code>~&lt;</code>) and SIGGAR (<code>~&gt;</code>) is a &quot;hint&quot;. Hints have a &quot;split&quot; form.</p>
<p>A split form hint begins with its &quot;head&quot;: a symbol name (in <code>%name</code> form) followed by a DOT. The rest of the hint is its &quot;tail&quot;.</p>
<p>The tail of a split form hint should be vertically separated, with comments aligned with the head. The tail should also be aligned with the head.</p>
<h1 id="running-hoons">Running hoons</h1>
<p>A running runechild is more often called simply a <strong>running</strong>. Currently, no hoon contains more than one running.</p>
<p>A running hoon may contain a runechild before the running. That runechild is called the <strong>head</strong> of the running hoon.</p>
<h2 id="runnings">Runnings</h2>
<p>A running contains one or more <strong>runstep lines</strong>. Runstep lines should be aligned at the <strong>runstep base column</strong>, with exceptions. The runstep base column location is usually one stop after the column location of the running, but there are exceptions, as described in &quot;Details&quot;.</p>
<p>Within a runstep line, the runsteps should be tightly aligned, or they should follow runstep inter-line alignment, as described next.</p>
<p>A running is terminated by a TISTIS, which should be aligned with the running. The TISTIS should be vertically separated, with comments aligned with the running, and with the runsteps.</p>
<h3 id="runstep-inter-line-alignment">Runstep inter-line alignment</h3>
<p>In a row of runsteps, runsteps after the first may have inter-line alignment. Within a running, the inter-line alignment column of runsteps is determined by their silo.</p>
<p><em>From <code>sys/zuse.hoon</code>, lines 4892-4905:</em></p>
<pre><code>        :~  ~2015.6.30..23.59.59   ~2012.6.30..23.59.59
            ~2008.12.31..23.59.58  ~2005.12.31..23.59.57
            ~1998.12.31..23.59.56  ~1997.6.30..23.59.55
            ~1995.12.31..23.59.54  ~1994.6.30..23.59.53
            ~1993.6.30..23.59.52   ~1992.6.30..23.59.51
            ~1990.12.31..23.59.50  ~1989.12.31..23.59.49
            ~1987.12.31..23.59.48  ~1985.6.30..23.59.47
            ~1983.6.30..23.59.46   ~1982.6.30..23.59.45
            ~1981.6.30..23.59.44   ~1979.12.31..23.59.43
            ~1978.12.31..23.59.42  ~1977.12.31..23.59.41
            ~1976.12.31..23.59.40  ~1975.12.31..23.59.39
            ~1974.12.31..23.59.38  ~1973.12.31..23.59.37
            ~1972.12.31..23.59.36  ~1972.6.30..23.59.35
        ==</code></pre>
<p>Each runstep line is a row. Within each row, the runsteps are slotted in lexical order.</p>
<h3 id="running-inherited-inter-line-alignment">Running-inherited inter-line alignment</h3>
<p>If a runstep is a basic syntax hoon, the runechildren of the basic syntax hoon may have a <strong>running-inherited</strong> inter-line alignment. In running-inherited inter-line alignment, every basic syntax hoon is a row. Within each row, first the rune of the hoon is slotted, then its runechildren in lexical order.</p>
<p>Within a running, the running-inherited inter-line alignment of a runechild is determined by the slot of the runechild.</p>
<p><em>From `sys/hoon.hoon', lines 5303-5308:</em></p>
<pre><code>    :~  :-  [&#39;a&#39; &#39;z&#39;]  (cook |=(a/@ta [%$ %tas a]) sym)
        :-  [&#39;0&#39; &#39;9&#39;]  (stag %$ bisk)
        :-  &#39;-&#39;        (stag %$ tash)
        :-  &#39;.&#39;        ;~(pfix dot perd)
        :-  &#39;~&#39;        ;~(pfix sig ;~(pose twid (easy [%$ %n 0])))
    ==</code></pre>
<h3 id="mixed-inter-line-alignments-in-a-running">Mixed inter-line alignments in a running</h3>
<p>A running should not have both running-inherited and runstep alignment. But note that if a basic syntax hoon is a runstep, it may have both a running-inherited inter-line alignment and a chained inter-line alignment. If a basic syntax hoon does have both inter-line alignments, they should be consistent. That is, for every slot, the column location of that slot according to running-inherited alignment should be identical to the column location of that slot according to chained alignment.</p>
<h1 id="jogging-hoons">Jogging hoons</h1>
<p>A jogging runechild is more often called simply a <strong>jogging</strong>. A Hoon statement contains at most one jogging.</p>
<p>In addition to the jogging, a jogging hoon may contain other runechildren, either before or after the jogging. An runechild after the jogging is called a <strong>tail</strong>. If there is one runechild before the jogging, it is called the <strong>head</strong> of the jogging hoon. If there are two runechildren before the jogging, they are called, in order, the <strong>head</strong> and <strong>subhead</strong> of the jogging.</p>
<h2 id="joggings">Joggings</h2>
<p>A jogging is a gap-separated sequence of one or more jogs. Every <strong>jog</strong> contains a <strong>jog head</strong>, followed by a gap and a <strong>jog body</strong>. Note that it is important to distinguish between the head of a jogging hoon, defined above, and the head of a jog.</p>
<h3 id="chess-sidedness">Chess-sidedness</h3>
<p>Jogs, joggings and jogging hoons have <strong>chess-sidedness</strong>. Chess-sidedness is always either kingside and queenside. Informally, <strong>kingside</strong> means the indentation has a left-side bias; and <strong>queenside</strong> means that the indentation has a right-side bias. The effect of sidedness on indentation will be specified more precisely in the descriptions of jogs and of the individual types of jogging hoon. The general idea is that chess-sidedness stays consistent within a Hoon statement.</p>
<h2 id="jogs">Jogs</h2>
<p>The column location of a jog is that of its head. A jog is <strong>joined</strong> if its head is on the same line as its body. Otherwise, a jog is <strong>multiline</strong>. As explained below, a multiline jog may be either <strong>pseudo-joined</strong> or <strong>split</strong>.</p>
<p>Jogs are either kingside or queenside. In standard code, the sidedness of a jog determines the alignment of split jogs.</p>
<p>The base column location of a jog depends on the chess-sidedness of the jogging hoon. The base column of kingside jogs is one stop after the anchor column. The base column of queenside jogs is two stops after the anchor column.</p>
<h3 id="joined-jogs">Joined jogs</h3>
<p>A joined jog may be either <strong>inter-line aligned</strong> or <strong>ragged</strong>. A joined jog is ragged if its body is tightly aligned. Otherwise, a joined jog is considered inter-line aligned. A jog may also be pseudo-joined.</p>
<p>All inter-line aligned jogging should be aligned at the jogging body column. With each jogging, at most one column is designated as the <strong>jogging body column</strong> of the jogging.</p>
<h3 id="split-jogs">Split jogs</h3>
<p>The gap of split jog should be a vertical gap with comments at the column location of the jog body. The standard column location of the body of a split jog varies according to the sidedness of the jog:</p>
<ul>
<li><p>The column location of the body of a split kingside jog should be aligned one stop <strong>after</strong> the jog's head.</p></li>
<li><p>The column location of the body of a split queenside jog should be aligned one stop <strong>before</strong> the jog's head.</p></li>
</ul>
<h2 id="jogging-terminator">Jogging terminator</h2>
<p>A jogging is terminated by a TISTIS, which should be aligned with the jogging. The TISTIS should be vertically separated, with comments aligned with the jogging, and at the jog base column.</p>
<h1 id="batteries">Batteries</h1>
<p>The column at which a battery starts is the <strong>base column</strong> of the battery. The arms of a battery should all align at the the base column of the battery. The arms should be separated by vertical gaps, where the comments are at the base column, as well as two stops after the base column. The base column of the battery is specified below, in the description of each battery hoon. Arms may be joined or split.</p>
<p>Battery hoons are joined or split according to whether the battery is horizontally or vertically separated. A joined battery should be tightly aligned. A split battery should be vertically separated, with comments at the battery base column; and with the battery itself aligned at the battery base column.</p>
<p>A battery should be followed by a HEPHEP, aligned at the battery base column. The HEPHEP should be vertically separated, with comments at the battery base column as well as one step after the battery base column.</p>
<p><em>From sieve_k example, line 6:</em></p>
<pre><code>++  abet  (sort (~(tap in fed)) lth)</code></pre>
<p>A joined arm consists of, in lexical order:</p>
<ul>
<li><p>A arm marker.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>The arm head.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>The arm body.</p></li>
</ul>
<p><em>From sieve_k example, lines 7-12:</em></p>
<pre><code>++  main
  =+  fac=2
  |-  ^+  ..main
  ?:  (gth (mul fac fac) top)
    ..main
  $(fac +(fac), ..main (reap fac))</code></pre>
<p>A split arm consists of, in lexical order:</p>
<ul>
<li><p>A arm marker.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>The arm head.</p></li>
<li><p>A vertical gap, with comments at the base column,</p></li>
<li><p>The arm body, aligned one stop after the anchor column.</p></li>
</ul>
<h1 id="criss-cross-lines">Criss-cross lines</h1>
<p><em>From <code>arvo/sys/zuse.hoon</code>, lines 906-918 :</em></p>
<pre><code>          $:  $:  our/ship                              ::  host
                  src/ship                              ::  guest
                  dap/term                              ::  agent
              ==                                        ::
              $:  wex/boat                              ::  outgoing subs
                  sup/bitt                              ::  incoming subs
              ==                                        ::
              $:  ost/bone                              ::  opaque cause
                  act/@ud                               ::  change number
                  eny/@uvJ                              ::  entropy
                  now/@da                               ::  current time
                  byk/beak                              ::  load source
          ==  ==                                        ::</code></pre>
<p>Recall that a boundary is a HEPHEP (<code>--</code>) or a TISTIS (<code>==</code>). Successive boundaries may occur on the same line, as part of a <strong>criss-cross boundary line</strong>. A boundary is in a criss-cross line does not have to be aligned correctly, if some other boundary with the required alignment &quot;stands in&quot; for it.</p>
<p>Note, however, that since every boundary on the line requires some boundary to be aligned according to this standard, all of the boundaries end up with an alignment requirement. In the example above, the two boundaries on line 918 stand in for each other, and each imposes an alignment requirement on the other.</p>
<p>Criss-cross lines are so called because if you draw a line from each boundary on the criss-cross line to the rune that it matches syntactically, you end up with a set of lines, each of which crosses all the others.</p>
<p>Only one kind of boundary should appear in a criss-cross line. Every character in a criss-cross line should be part of a boundary, or part of a gap.</p>
<h1 id="sail">Sail</h1>
<p>Sail statements start with a semicolon. Sail statements do not curry.</p>
<h2 id="sail-1-fixed-runes">Sail 1-fixed runes</h2>
<p><em>From <code>ren/tree/head.hoon</code>, lines 35-43:</em></p>
<pre><code>    ;*  ?.  nopack.dbg
          :_  ~
          ;link(type &quot;text/css&quot;, rel &quot;stylesheet&quot;, href &quot;/===/web/pack/css/codemirror-fonts-bootstrap-tree.css&quot;);
        ;=
          ;link(type &quot;text/css&quot;, rel &quot;stylesheet&quot;, href &quot;/===/web/lib/css/fonts.css&quot;);
          ;link(type &quot;text/css&quot;, rel &quot;stylesheet&quot;, href &quot;/===/web/lib/css/bootstrap.css&quot;);
          ;link(type &quot;text/css&quot;, rel &quot;stylesheet&quot;, href &quot;/===/web/lib/css/codemirror.css&quot;);
          ;link(type &quot;text/css&quot;, rel &quot;stylesheet&quot;, href &quot;/===/web/tree/main.css&quot;);
        ==</code></pre>
<p>The sail 1-fixed runes are SEMHEP (;-), SEMLUS (;+), SEMTAR (;*), and SEMCEN (;%). They have a single runechild. The rune child should be separated from the rune by a one-stop flat gap.</p>
<h2 id="semtis">SEMTIS</h2>
<p><em>From <code>ren/tree/head.hoon</code>, lines 59-64:</em></p>
<pre><code>        ;=
::           ;script(type &quot;text/javascript&quot;, src &quot;/===/web/lib/js/hoon.js&quot;);
          ;script(type &quot;text/javascript&quot;, src &quot;/===/web/tree/main.js&quot;);
          ;script(type &quot;text/javascript&quot;, src &quot;{?.(aut &quot;&quot; &quot;/~~/~/at&quot;)}&quot;.
                                              &quot;/===/web/lib/js/urb.js&quot;);
        ==</code></pre>
<p>SEMTIS (;=) takes a TISTIS-terminated list of sail statements. It is split or joined, depending on whether the first element of the list is on the same line as the SEMTIS.</p>
<p>If joined, the first element of the list should be tightly aligned. If split, the first elements of the list should be aligned one stop after the SEMTIS, and the first element should be preceded by a vertical gap with comments aligned at the SEMTIS and with the first element.</p>
<p>All subsequent elements should be aligned with the first element. For a joined SEMTIS, this implies that all elements after the first should be aligned two stops after the SEMTIS. For a split SEMTIS, this implies that all elements after the first should be aligned one stop after the SEMTIS.</p>
<p>All elements after the first should be preceded by a vertical gap, with comments aligned at the SEMTIS as well as with the first element.</p>
<p>The TISTIS should be aligned with the SEMTIS. The TISTIS should be vertically separated with comments aligned at the SEMTIS as well as with the first element.</p>
<h2 id="tagged-sail-statements">Tagged sail statements</h2>
<p><em>Adapted from <code>web/dojo.hoon</code>, lines 13-27:</em></p>
<pre><code>;module
    =nav_title    &quot;Dojo&quot;
    =nav_no-dpad  &quot;&quot;
    =nav_no-sibs  &quot;&quot;
  ;script(src &quot;//cdnjs.cloudflare.com/ajax/libs/mousetrap/1.4.6/mousetrap.js&quot;);
  ;style:&#39;&#39;&#39;
         #term { width: 100%; }
         #term * { margin: 0px; }
         .module pre { margin-bottom: 0; }
         &#39;&#39;&#39;
  ;div#err;
  ;div#term:&quot;&quot;
  ;script@&quot;/lib/js/sole.js&quot;;
  ;sole(appl &quot;dojo&quot;);
==</code></pre>
<p>Tagged sail statement are always split. The conventions for the sail attributes are described below. All elements should be aligned one stop after the start of the statement. The tagged statement is considered to start at the semicolon which starts the tag that is its keyword.</p>
<p>All elements should be preceded by a vertical gap. Comments in the vertical gaps should be aligned at the start of the statement as well as with the first element.</p>
<p>The TISTIS should be aligned with the tagged sail statement that it terminates. The TISTIS should be preceded by a vertical gap, with comments aligned with the tagged sail statement, as well as with the first element.</p>
<h2 id="sail-attributes">Sail attributes</h2>
<p>The sail attribute base column is two stops after start column location of the sail text block. Sail tall attributes should be separated from each other by a vertical gap with comments aligned at the attribute base column. Values in sail attributes should be on the same line as the sail key. The sail attribute values should be tightly aligned, or aligned with each other.</p>
<h1 id="selgap">SELGAP</h1>
<p><em>From <code>arvo/sur/twitter.hoon</code>, line 85:</em></p>
<pre><code>     [  {$mentions $~}                %get   /statuses/mentions-timeline  ]</code></pre>
<p>Whitespace in one-line SELGAP's is free-form -- <code>hoonlint</code> never generates a warning for them.</p>
<p>Only one-line SELGAP's occur in the <code>arvo</code> corpus. If <code>hoonlint</code> encounters a multi-line SELGAP, it issues a &quot;not yet implemented&quot; warning.</p>
<h1 id="details">Details</h1>
<h2 id="currying-basic-syntax-hoons">Currying basic syntax hoons</h2>
<p>The basic syntax hoons curry as follows:</p>
<ul>
<li><p>BARDOT curries with CENHEP, CENLUS, KETTIS, and LUSLUS.</p></li>
<li><p>BARHEP curries with KETTIS and TISDOT.</p></li>
<li><p>BARTIS curries with COLHEP.</p></li>
<li><p>CENDOT curries with BARTIS and CENHEP.</p></li>
<li><p>CENHEP curries with CENHEP, COLHEP, TISLUS, and TISGAL.</p></li>
<li><p>CENLUS curries with CENHEP and TISLUS.</p></li>
<li><p>COLCAB curries with CENHEP, CENLUS, and COLCAB.</p></li>
<li><p>COLHEP curries with CENLUS and COLCAB.</p></li>
<li><p>KETHEP curries with BARDOT, BARHEP, BARSIG, BARTIS, CENHEP, CENLUS, COLHEP, KETHEP, KETSIG, KETTIS, TISFAS, TISGAL, TISHEP, TISTAR, TISDOT, SIGLUS, and ZAPGAR.</p></li>
<li><p>KETLUS curries with BARDOT, BARHEP, BARTIS, BARTAR, CENHEP, and TISGAL.</p></li>
<li><p>KETSIG curries with CENLUS.</p></li>
<li><p>KETWUT curries with BUCCAB and LUSLUS.</p></li>
<li><p>SIGCAB curries with BARTIS.</p></li>
<li><p>SIGFAS curries with LUSLUS.</p></li>
<li><p>SIGLUS curries with BARDOT, BARTIS, and CENLUS.</p></li>
<li><p>TISBAR curries with BUCCAB and BARTIS.</p></li>
<li><p>TISCOM curries with TISCOM.</p></li>
<li><p>TISDOT curries with TISLUS.</p></li>
<li><p>TISGAL curries with BARTIS, CENHEP, CENLUS, KETLUS, TISGAL, and TISGAR.</p></li>
<li><p>TISGAR curries with CENLUS and TISGAR.</p></li>
<li><p>WUTCOL curries with BARHEP, CENHEP, and WUTCOL.</p></li>
<li><p>WUTDOT curries with BARHEP.</p></li>
<li><p>WUTGAL curries with BARHEP.</p></li>
<li><p>WUTGAR curries with SIGBAR.</p></li>
<li><p>WUTSIG curries with TISLUS and WUTSIG.</p></li>
<li><p>ZAPCOL curries with LUSLUS.</p></li>
<li><p>ZAPDOT curries with LUSLUS.</p></li>
<li><p>ZAPGAR curries with CENHEP.</p></li>
</ul>
<h2 id="running-hoons-1">Running hoons</h2>
<p>There are two kinds of running hoons:</p>
<ul>
<li>A <strong>0-running</strong> has no head. The current 0-running rules are BUCCEN (<code>$%</code>), BUCCOL (<code>$:</code>), BUCWUT (<code>$?</code>), COLSIG (<code>:~</code>), COLTAR (<code>:*</code>), TISSIG (<code>=~</code>), WUTBAR (<code>?|</code>), and WUTPAM (<code>?&amp;</code>).</li>
</ul>
<!-- TISSIG is very problematic.
It's a 0-running implemented (why?) in hoon.hoon as a 1-running.
-->
<ul>
<li>A <strong>1-running</strong> has a head. The current 1-running rules are CENCOL (<code>%:</code>), DOTKET (<code>.^</code>), SEMCOL (<code>;:</code>), SEMSIG (<code>;~</code>).</li>
</ul>
<h2 id="running-hoons-2">0-running hoons</h2>
<p>0-running hoons may be either split or joined.</p>
<ul>
<li><p>COLSIG (<code>:~</code>) runes curry at CENDOT (<code>%.</code>), CENHEP (<code>%-</code>), CENLUS (<code>%+</code>), COLLUS (<code>:+</code>), KETHEP (<code>^-</code>), TISFAS (<code>~/</code>) and TISGAR (<code>~&gt;</code>).</p></li>
<li><p>COLTAR (<code>:*</code>) runes curry at CENHEP (<code>%-</code>).</p></li>
<li><p>TISSIG (<code>=~</code>) runes curry at TISGAR (<code>~&gt;</code>) and WUTLUS (<code>?+</code>).</p></li>
</ul>
<h3 id="joined-0-running-hoons">Joined 0-running hoons</h3>
<p><em>From <code>arvo/sys/zuse.hoon</code>, lines 2399-2402:</em></p>
<pre><code>              :~  [b er]
                  [b pk]
                  [(met 0 m) m]
              ==</code></pre>
<p>A joined 0-running hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>A running where runstep lines are aligned two stops after the anchor column. Runstep lines should be separated by vertical gaps with comments at the anchor column as well as aligned at the runstep lines.</p></li>
<li><p>A vertical gap with comments is the anchor column, as well as aligned at the runstep lines.</p></li>
<li><p>A TISTIS aligned at the anchor column.</p></li>
</ul>
<h3 id="split-0-running-hoons">Split 0-running hoons</h3>
<p>This example is the beginning and end of a long split 0-running hoon.</p>
<p><em>From <code>avro/sur/twitter.hoon</code>, lines 84-194:</em></p>
<pre><code>    :~
      [  {$mentions $~}                %get   /statuses/mentions-timeline  ]
      [  {$posts-by sd $~}             %get   /statuses/user-timeline  ]
      [  {$timeline $~}                %get   /statuses/home-timeline  ]
      [  {$retweets-mine $~}           %get   /statuses/retweets-of-me  ]
:: Lines 89-189 are omitted
      [  {$help-langs $~}              %get   /help/languages  ]
      [  {$help-privacy $~}            %get   /help/privacy  ]
      [  {$help-tos $~}                %get   /help/tos  ]
      [  {$rate-limit-info $~}         %get   /application/rate-limit-status  ]
    ==</code></pre>
<p>A split 0-running hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as aligned at the runstep lines.</p></li>
<li><p>A running where runstep lines are aligned one stop after the anchor column. The runstep lines are separated by vertical gaps with comments at the anchor column as well as aligned with the runstep lines.</p></li>
<li><p>A vertical gap, with comments at the anchor column, as well as aligned at the runstep lines.</p></li>
<li><p>A TISTIS aligned at the anchor column.</p></li>
</ul>
<!-- TODO: check all uses of runeColumn to be sure that
     anchor column is not what is intended -->
<h2 id="running-hoons-3">1-running hoons</h2>
<p>1-running hoon statements do not curry. 1-running hoons can be joined or split.</p>
<h3 id="joined-1-running-hoons">Joined 1-running hoons</h3>
<p><em>From <code>arvo/sys/hoon.hoon</code>, lines 4853-4855:</em></p>
<pre><code>             ;~  less  soz
               (ifix [soq soq] (boss 256 (more gon qit)))
             ==</code></pre>
<p>A joined 1-running hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>The first runstep line.</p></li>
<li><p>A vertical gap with comments at the anchor column, as well as aligned one stop after the anchor column.</p></li>
<li><p>The remainder of the running, where runstep lines are aligned one stop after the anchor column. The runsteps lines should be separated by vertical gaps with comments at the anchor column as well as aligned one stop after the anchor column.</p></li>
<li><p>A vertical gap with comments at the anchor column as well as aligned one stop after the anchor column.</p></li>
<li><p>A TISTIS aligned at the anchor column.</p></li>
</ul>
<h3 id="split-1-running-hoons">Split 1-running hoons</h3>
<p><em>From <code>arvo/sys/zuse.hoon</code>, lines 4048-4051:</em></p>
<pre><code>      ;~  pose
        (cold &amp; (jest &#39;true&#39;))
        (cold | (jest &#39;false&#39;))
      ==</code></pre>
<p>A split 1-running hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, with comments at the anchor column, as well as aligned one stop after the anchor column.</p></li>
<li><p>A running where runstep lines are aligned one stop after the anchor column. Comments in the running are aligned at the anchor column as well as aligned one stop after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column, as well as aligned one stop after the the anchor column.</p></li>
<li><p>A TISTIS aligned at the anchor column.</p></li>
</ul>
<h2 id="jogging-hoons-1">Jogging hoons</h2>
<p>There are currently four kinds of jogging hoon:</p>
<ul>
<li><p>The current 1-jogging rules are CENTIS (<code>%=</code>), CENCAB (<code>%_</code>) and WUTHEP (<code>?-</code>). A 1-jogging has one head and no tail.</p></li>
<li><p>The current 2-jogging rules are CENTAR (<code>%*</code>) and WUTLUS (<code>?+</code>). A 2-jogging has a head and a subhead but no tail.</p></li>
<li><p>The current jogging-1 rule is TISCOL (<code>=:</code>). A jogging-1 has a tail and no head.</p></li>
<li><p>The current 2-jogging-1 statement is SIGCEN (<code>~%</code>). A 2-jogging-1 statement has a head, a subhead, and a tail.</p></li>
</ul>
<h2 id="jogging-hoons-2">1-jogging hoons</h2>
<p>Every 1-jogging hoon is either kingside or queenside. 1-jogging runes curry with KETLUS (<code>^+</code>).</p>
<h3 id="kingside-1-jogging-hoons">Kingside 1-jogging hoons</h3>
<p><em>From <code>arvo/sys/hoon.hoon</code>, lines 6330-6334:</em></p>
<pre><code>  ?-  pex
    {$1 $0}  yom
    {$1 $1}  woq
    *        [%6 pex yom woq]
  ==</code></pre>
<p>A kingside 1-jogging hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as the jog base column.</p></li>
<li><p>A kingside jogging. The jog base column should be one stop after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as the jog base column.</p></li>
<li><p>A TISTIS, starting at the anchor column.</p></li>
</ul>
<h3 id="queenside-1-jogging-hoons">Queenside 1-jogging hoons</h3>
<p><em>From <code>arvo/sys/hoon.hoon</code>, lines 6305-6309:</em></p>
<pre><code>  ?-    nug
      {$0 *}   p.nug
      {$10 *}  $(nug q.nug)
      *        ~_(leaf+&quot;cove&quot; !!)
  ==</code></pre>
<p>A queenside 1-jogging hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A 2-stop flat gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as the jog base column.</p></li>
<li><p>A queenside jogging. The jog base column should be two stops after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as the jog base column.</p></li>
<li><p>A TISTIS, aligned at the anchor column.</p></li>
</ul>
<h2 id="jogging-hoons-3">2-jogging hoons</h2>
<p>If the head and subhead of a 2-jogging hoon are on the same line, the 2-jogging hoon is called <strong>head-joined</strong>. If the head and subhead of a 2-jogging hoon are on different lines, the 2-jogging hoon is called <strong>head-split</strong>.</p>
<p>2-jogging Hoon runes do not curry.</p>
<h3 id="kingside-head-joined-2-jogging-hoons">Kingside head-joined 2-jogging hoons</h3>
<p><em>From <code>arvo/sys/hoon.hoon</code>, lines 6583-6586:</em></p>
<pre><code>      ?+  p.mod  [%rock %$ 0]
        $cell  [[%rock %$ 0] [%rock %$ 0]]
        $void  [%zpzp ~]
      ==</code></pre>
<p>A head-joined kingside 2-jogging hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>Its subhead.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as the jog base column.</p></li>
<li><p>A kingside jogging. The jog base column should be one stop after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as the jog base column.</p></li>
<li><p>A TISTIS, aligned at the anchor column.</p></li>
</ul>
<h3 id="kingside-head-split-2-jogging-hoons">Kingside head-split 2-jogging hoons</h3>
<p><em>From <code>hoons/arvo/app/hall.hoon</code>, lines 1772-1781:</em></p>
<pre><code>    ?+  -.det
      =&lt;  sa-done
      %.  det
      =+  (fall (~(get by stories) nom) *story)
      ~(sa-change sa nom -)
    ::
      $new      (da-create nom +.det)
      $bear     ~&amp;(%unexpected-unsplit-bear +&gt;)
      $remove   (da-delete nom)
    ==</code></pre>
<p>A head-split kingside 2-jogging hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>Its subhead, aligned one stop before the head.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as the jog base column.</p></li>
<li><p>A kingside jogging. The jog base column should be one stop after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as the jog base column.</p></li>
<li><p>A TISTIS, aligned at the anchor column.</p></li>
</ul>
<h3 id="queenside-head-joined-2-jogging-hoons">Queenside head-joined 2-jogging hoons</h3>
<p><em>From <code>arvo/sys/vane/ames.hoon</code>, lines 1568-1575:</em></p>
<pre><code>      ?+    lot  ~
          [$$ %ud @]
        (perm p.why u.hun q.p.lot [syd t.tyl])
      ::
          [$$ %da @]
        ?.  =(now q.p.lot)  ~
        (temp p.why u.hun [syd t.tyl])
      ==</code></pre>
<p>A head-joined queenside 2-jogging hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A 2-stop flat gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>Its subhead.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as the jog base column.</p></li>
<li><p>A queenside jogging. The jog base column should be two stops after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as the jog base column.</p></li>
<li><p>A TISTIS, aligned at the anchor column.</p></li>
</ul>
<h3 id="queenside-head-split-2-jogging-hoons">Queenside head-split 2-jogging hoons</h3>
<p><em>Adapted from <code>arvo/lib/hood/kiln.hoon</code>, starting at line 582:</em></p>
<pre><code>    ?+    gem
        (spam leaf+&quot;strange auto&quot; &gt;gem&lt; ~)
    ::
        $init
      =+  :-  &quot;auto merge failed on strategy %init&quot;
          &quot;I&#39;m out of ideas&quot;
      lose:(spam leaf+-&lt; leaf+-&gt; [&gt;p.p.are&lt; q.p.are])
    ::
    ==</code></pre>
<p>A head-split queenside 2-jogging hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A 2-stop flat gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>Its subhead, aligned one stop before the head.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as the jog base column.</p></li>
<li><p>A queenside jogging. The jog base column should be two stops after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as the jog base column.</p></li>
<li><p>A TISTIS, aligned at the anchor column.</p></li>
</ul>
<h2 id="jogging-1-hoons">Jogging-1 hoons</h2>
<!-- "Split" form addressed in Github issue #31" -->
<p>Jogging-1 hoons do not curry.</p>
<p><em>From <code>arvo/sys/hoon.hoon</code>, lines 9720-9727:</em></p>
<pre><code>          =:  hos  ~
              wec  [~ ~ ~]
            ==
          ::  descend into cell
          ::
          :+  %cell
            dext(sut p.sut, ref (peek(sut ref) %free 2))
          dext(sut q.sut, ref (peek(sut ref) %free 3))</code></pre>
<p>Every jogging-1 hoon is considered kingside. A jogging-1 hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>A kingside jogging. The jog base column should be two stops after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column as well as the jog base column.</p></li>
<li><p>A TISTIS, aligned one stop after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A tail, aligned at the anchor column.</p></li>
</ul>
<h2 id="sigcen">SIGCEN</h2>
<p>SIGCEN does not curry.</p>
<p><em>From <code>sys/hoon.hoon</code>, lines 3684-6234:</em></p>
<pre><code>~%    %qua
    +
  ==
    %mute  mute
    %show  show
  ==
|%
:: Lines 3691-6233 are omitted
--</code></pre>
<p>SIGCEN statements can be regarded either a special form of a jogging hoon, or as a 4-fixed hoon with, optionally, an unusual 3rd runechild.</p>
<p>SIGCEN, except for its 3rd runechild, is treated as an ordinary 4-ary basic syntax hoon. SIGCEN's 3rd runechild may be either <code>~</code> or a jogging bounded by TISTIS lines. The jogging is always kingside and elements are never split.</p>
<p>The initial TISTIS should be backdented appropriately for a third runechild. The final TISTIS should be aligned with the initial TISTIS.</p>
<p>The initial TISTIS should be followed by a vertical gap with comments aligned with the TISTIS as well as with the jogs. The final TISTIS should be followed by a vertical gap with comments aligned with the TISTIS as well as with the jogs.</p>
<p>The jog head should be aligned one stop after the initial TISTIS. The jog body should be tightly aligned, or inter-line aligned with other bodies in the formula list. Successive formulas should be separated by a vertical gap with comments aligned with the jogs.</p>
<h2 id="battery-hoons">Battery hoons</h2>
<p>The battery hoons are BARCAB, BARCEN and BARKET.</p>
<h3 id="battery-arm-currying">Battery arm currying</h3>
<p>An arm marker can be curried, but it must be the anchor rune, or must curry with BARCEN. As a special case, an arm marker has a per-rune offset of one stop.</p>
<h3 id="barcen">BARCEN</h3>
<p>BARCEN may curry with KETBAR or KETWUT. It may be joined or split.</p>
<h4 id="split-barcen">Split BARCEN</h4>
<p><em>From the sieve_k example:</em></p>
<pre><code>|%
++  abet  (sort (~(tap in fed)) lth)
++  main
  =+  fac=2
  |-  ^+  ..main
  ?:  (gth (mul fac fac) top)
    ..main
  $(fac +(fac), ..main (reap fac))
::
++  reap
  |=  fac=@
  =+  cot=(mul 2 fac)
  |-  ^+  ..reap
  ?:  (gth cot top)
    ..reap
  $(cot (add cot fac), fed (~(del in fed) cot))
--</code></pre>
<p>A split BARCEN should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A battery whose base column is the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A HEPHEP, aligned at the anchor column.</p></li>
</ul>
<h4 id="joined-barcen">Joined BARCEN</h4>
<p><em>From <code>arvo/sys/zuse.hoon</code>, lines 176-181:</em></p>
<pre><code>      |%  ++  seal  |~({a/pass b/@ c/@} *@)             ::  encrypt to a
          ++  sign  |~({a/@ b/@} *@)                    ::  certify as us
          ++  sure  |~({a/@ b/@} *(unit @))             ::  authenticate from us
          ++  tear  |~  {a/pass b/@}                    ::  accept from a
                    *(unit {p/@ q/@})                   ::
      --  ::as                                          ::</code></pre>
<p>A joined BARCEN should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one stop flat gap.</p></li>
<li><p>A battery whose base column is two stops after anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A HEPHEP, aligned at the anchor column.</p></li>
</ul>
<h3 id="barcab">BARCAB</h3>
<p>BARCAB runes do not curry.</p>
<p><em>From <code>sys/vane/jael.hoon</code>, lines 697-827:</em></p>
<pre><code>  |_  pig/safe
  ::                                                    ::  ++delete:up
  ++  delete                                            ::  delete right
    |=  ryt/rite
    ^-  safe
:: Lines 701-820 omitted
  ::
  ++  update                                            ::  arbitrary change
    |=  del/bump
    ^-  safe
    (splice(pig (remove les.del)) mor.del)
  --</code></pre>
<p>A BARCAB should consist of, in lexical order:</p>
<ul>
<li><p>Its rune</p></li>
<li><p>A one stop horizontal gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, with comments at the anchor column, as well as one stop after the anchor column.</p></li>
<li><p>A battery, whose base column location should be the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column, as well as one stop after the anchor column.</p></li>
<li><p>A HEPHEP, aligned at the anchor column.</p></li>
</ul>
<h3 id="barket">BARKET</h3>
<p>BARKET runes do not curry.</p>
<p><em>From <code>arvo/sys/zuse.hoon</code>, lines 3975-4025:</em></p>
<pre><code>    |^  |=(val/json (apex val &quot;&quot;))
    ::                                                  ::  ++apex:en-json:html
    ++  apex
      |=  {val/json rez/tape}
      ^-  tape
:: Lines 3980-4015 omitted
    ::                                                  ::  ++jesc:en-json:html
    ++  jesc                                            ::  escaped
      =+  utf=|=(a/@ [&#39;\\&#39; &#39;u&#39; ((x-co 4):co a)])
      |=  a/@  ^-  tape
      ?+  a  ?:((gth a 0x1f) [a ~] (utf a))
        $10  &quot;\\n&quot;
        $34  &quot;\\\&quot;&quot;
        $92  &quot;\\\\&quot;
      ==
    --  ::en-json</code></pre>
<p>A BARKET should consist of, in lexical order:</p>
<ul>
<li><p>Its rune</p></li>
<li><p>A one stop horizontal gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, with comments at the anchor column, as well as one stop after the anchor column.</p></li>
<li><p>A battery, whose base column location should be the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column, as well as one stop after the anchor column.</p></li>
<li><p>A HEPHEP, aligned at the anchor column.</p></li>
</ul>
<h2 id="ford-hoons">Ford hoons</h2>
<h3 id="ford-1-hoons">Ford-1 hoons</h3>
<p>The ford-1 hoons are a set of unary ford hoons: FASSIG (<code>/~</code>), FASBUC (<code>/$</code>), FASCAB (<code>/_</code>), FASCEN (<code>/%</code>), FASFAS (<code>//</code>), FASHAX (<code>/#</code>) and FASWUT (<code>/?</code>).</p>
<p><em>From <code>arvo/app/hall.hoon</code>, line 17:</em></p>
<pre><code>          /~  |=({t/telegram:hall bowl:gall} t)</code></pre>
<p><em>From <code>hoons/arvo/mar/rss-xml.hoon</code>, line 6:</em></p>
<pre><code>//  /===/mar/xml  :: alias</code></pre>
<p>A tall ford-1 hoon should consist of, in lexical order:</p>
<ul>
<li><p>The rune.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>The runechild.</p></li>
</ul>
<h3 id="ford-hoof-hoons">Ford hoof hoons</h3>
<p>The ford hoof hoons are FASHEP (<code>/-</code>) and FASLUS (<code>/+</code>).</p>
<p><em>From <code>../hoons/arvo/app/dojo.hoon</code>, line 5:</em></p>
<pre><code>/-  sole, lens                                          ::  console structures</code></pre>
<p><em>From <code>hoons/arvo/mar/twit/feed.hoon</code>, line 6:</em></p>
<pre><code>/+  twitter, httr-to-json, old-zuse</code></pre>
<p>A tall Ford hoof hoon should consist of, in lexical order:</p>
<ul>
<li><p>The rune.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>The runechild.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
</ul>
<h3 id="sequence-ford-hoons">0-sequence Ford hoons</h3>
<p>The 0-sequence Ford hoons are those whose only runechild is a sequence of Forn hoons. FASBAR (<code>/|</code>) and FASDOT (<code>/.</code>) are the 0-sequence Ford hoons. The &quot;0-&quot; prefix is for orthogonality with &quot;0-running&quot; hoons.</p>
<p><em>From <code>hoons/arvo/app/hall.hoon</code>, lines 16-18:</em></p>
<pre><code>      /|  /:  /%/filter  /!noun/
          /~  |=({t/telegram:hall bowl:gall} t)
      ==</code></pre>
<!-- No FASDOT code in the current arvo corpus is standard,
do this is a revised example.
-->
<p><em>Adapted from <code>hoons/arvo/web/pack/css/codemirror-fonts-bootstrap-tree.hoon</code>, lines 6-10:</em></p>
<pre><code>  /.  /:/===/web/lib/css/codemirror:/css/
      /:/===/web/lib/css/fonts:/css/
      /:/===/web/lib/css/bootstrap:/css/
      /:/===/web/tree/main:/css/
  ==</code></pre>
<p>A tall 0-sequence Ford hoon should consist of, in lexical order:</p>
<ul>
<li><p>The rune.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>A sequence of ford hoons.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A TISTIS.</p></li>
</ul>
<h3 id="ford-hoon-sequence">Ford hoon sequence</h3>
<p>A Ford hoon sequence is a sequence of ford hoons. All of the ford hoons should be at the same alignment.</p>
<p>The hoons in the sequence should be separated by vertical gaps. The comments in the vertical gaps should be aligned with the rune of the hoon which directly contains the Ford hoon sequence.</p>
<h3 id="ford-2-hoons">Ford-2 hoons</h3>
<p>The Ford-2 hoons are FASCOL (<code>/:</code>), FASKET (<code>/^</code>), FASPAM (<code>/&amp;</code>), and FASSEM (<code>/;</code>).</p>
<!-- Note FASPAM tall whitespacing in conjectured, based
on parallel with FASKET. --
no examples of tall FASPAM exist in the arvo corpus.
-->
<p><em>From <code>hoons/arvo/app/gmail.hoon</code>, line 21:</em></p>
<pre><code>/=  rfctext  /:  /%/rfc  /txt/</code></pre>
<p><em>From <code>hoons/arvo/app/hall.hoon</code>, lines 15-18:</em></p>
<pre><code>      /^  $-({telegram:hall bowl:gall} telegram:hall)
      /|  /:  /%/filter  /!noun/
          /~  |=({t/telegram:hall bowl:gall} t)
      ==</code></pre>
<p><em>From <code>hoons/arvo/ren/tree/index.hoon</code>, line 7:</em></p>
<pre><code>    /;  (getall:tree /h1/h2/h3/h4/h5/h6)  /tree-elem/</code></pre>
<p>Whitespace conventions for the Ford-2 hoons are the same as those for basic syntax 2-arity hoons.</p>
<h3 id="fascom">FASCOM</h3>
<!-- FASCOM is not well represented in the arvo
database, and a lot of these rules are extrapolations --
they are not actual examples in the corpus.
The remnants of the two-stop Ford convention in the
corpus make extrapolation from the examples next
to impossible.
I use indentation-conservation heavily as the guideline
for extrapolation.
-->
<h4 id="joined-fascom">Joined FASCOM</h4>
<p>All joined FASCOM's are considered &quot;queenside&quot;.</p>
<p><em>From <code>hoons/arvo/ren/css.hoon</code>, lines 6-8:</em></p>
<pre><code>/,  /web/pack/css  /%   /!css/
    /              /~  !!
==</code></pre>
<p>A tall joined FASCOM hoon should consist of, in lexical order:</p>
<ul>
<li><p>The rune.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>A sequence of FASCOM elements, all of which are aligned with the first one.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A TISTIS.</p></li>
</ul>
<h4 id="kingside-split-fascom">Kingside split FASCOM</h4>
<!-- The split FASCOM examples are based
on the only arvo example of a split FASCOM.
It was anchored and non-standard, and therefore
I have revised it.
-->
<p><em>Adapted from <code>hoons/arvo/ren/tree/elem.hoon</code>, lines 5-8:</em></p>
<pre><code>/,
  /web  /|(/!elem/ /elem/)
  /     /elem/
==</code></pre>
<p>A tall kingside split FASCOM hoon should consist of, in lexical order:</p>
<ul>
<li><p>The rune.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A sequence of FASCOM elements, all of which are aligned one stop after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A TISTIS.</p></li>
</ul>
<h4 id="queenside-split-fascom">Queenside split FASCOM</h4>
<!-- The split FASCOM examples are based
on the only arvo example of a split FASCOM.
It was anchored and non-standard, and therefore
I have revised it.
-->
<p><em>Adapted from <code>hoons/arvo/ren/tree/elem.hoon</code>, lines 5-8:</em></p>
<pre><code>/,
    /web  /|(/!elem/ /elem/)
    /     /elem/
==</code></pre>
<p>A tall queenside split FASCOM hoon should consist of, in lexical order:</p>
<ul>
<li><p>The rune.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A sequence of FASCOM elements, all of which are aligned two stops after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A TISTIS.</p></li>
</ul>
<h4 id="fascom-element-sequence">FASCOM element sequence</h4>
<p><em>From <code>hoons/arvo/ren/css.hoon</code>, lines 6-8:</em></p>
<pre><code>/,  /web/pack/css  /%   /!css/
    /              /~  !!
==</code></pre>
<p>A FASCOM element sequence consists of a one or more <strong>FASCOM elements</strong>. The head of all the FASCOM elements should be aligned at the same column. The FASCOM elements should be separated by vertical gaps, with comments at the anchor column as well as aligned with the heads of the FASCOM elements.</p>
<p>A FASCOM element is considered joined or split, depending on the gap between the head and the body. If joined, the body of the FASCOM element is separated from the head by a one-stop gap, or an equivalent pseudo-join.</p>
<p>If the FASCOM element is split, the body of the FASCOM element should be separated by a vertical gap with comments at the body column. The body of a kingside FASCOM element should be aligned one stop <strong>after</strong> the head of the FASCOM element. The body of a queenside FASCOM element should be aligned one stop <strong>before</strong> the head of the FASCOM element.</p>
<h3 id="fastis">FASTIS</h3>
<pre><code>/=  rfctext  /:  /%/rfc  /txt/</code></pre>
<p>A tall FASTIS hoon should consist of, in lexical order:</p>
<ul>
<li><p>The FASTIS rune.</p></li>
<li><p>A one-stop flat gap.</p></li>
<li><p>A runechild.</p></li>
</ul>
<h1 id="appendix-non-standard-code">Appendix: Non-standard code</h1>
<p>Recall that, by non-standard code, in this document we mean code that does not follow the guidelines of this document. In non-standard code, <code>hoonlint</code> sometimes must decide the &quot;intended&quot; syntax, in order to produce diagnostics that are as helpful as possible. This appendix describes the methods used for deciding what was &quot;intended&quot; in non-standard Hoon code.</p>
<h2 id="chess-sidedness-1">Chess-sidedness</h2>
<p>A jog is considered queenside if it is aligned 2 stops or more after the base column of the jogging. Otherwise, the jog is considered kingside.</p>
<p>The chess-sidedness of a jogging is that of the majority of its jogs. In case of a tie, the jogging is considered to be queenside. The chess-sidedness of a jogging hoon is that of its jogging.</p>
<h2 id="jogging-body-column">Jogging body column</h2>
<p>In non-standard code, the jogging body column of a jogging is considered to be the most common start column of the bodies of the jogging's inter-line aligned jogs. If more than one column is &quot;most common&quot;, the tie is resolved in favor of the body column that is lexically first. If there are no inter-line aligned jogs in a jogging, the jogging body column is undefined.</p>
<h2 id="inter-line-alignment-1">Inter-line alignment</h2>
<p>&quot;Attached&quot; slots are those with tight or backdented alignment. All other slots are &quot;floating&quot;. In non-standard code, the column location of the inter-line alignment of a silo of slots is the column location most common in the &quot;floating&quot; slots.</p>
<p>If there are no floating slots, the inter-line alignment column location is irrelevant and undefined. If two column locations tie in the count of floating slots, the tie is broken using the overall count of slots, including both floating and attached slots, with that column location. If two column locations remain tied, even after taking into account the overall count of slots, then the tie is broken in favor of the column location that occurs first, lexically.</p>
<p>If no floating slot has an overall slot count of at least 2, the inter-line alignment column location is undefined. The idea is that the inter-line alignment must actually be an alignment shared by two different lines.</p>
<p>Each silo is examined separately. For each silo, only rows with an element in that silo's slot participate in the calculation.</p>
<p>If a running could have both a runstep alignment, and a running-inherited alignment, the runstep alignment takes precedence. In other words, if a running has runstep alignment, the running-inherited alignment is undefined.</p>
<h1 id="appendix-formal-definition-of-vertical-gap-body">Appendix: Formal definition of &quot;vertical gap body&quot;</h1>
<p>The format of a vertical gap body obeys this BNF:</p>
<pre><code>:start ::= gapComments
gapComments ::= OptExceptions Body
gapComments ::= OptExceptions
Body ::= InterPart PrePart
Body ::= InterPart
Body ::= PrePart
InterPart ::= InterComponent
InterPart ::= InterruptedInterComponents
InterPart ::= InterruptedInterComponents InterComponent

InterruptedInterComponents ::= InterruptedInterComponent+
InterruptedInterComponent ::= InterComponent Exceptions
InterComponent ::= Staircases
InterComponent ::= Staircases InterComments
InterComponent ::= InterComments

InterComments ::= InterComment+

Staircases ::= Staircase+
Staircase ::= UpperRisers Tread LowerRisers
UpperRisers ::= UpperRiser+
LowerRisers ::= LowerRiser+

PrePart ::= ProperPreComponent OptPreComponents
ProperPreComponent ::= PreComment
OptPreComponents ::= PreComponent*
PreComponent ::= ProperPreComponent
PreComponent ::= Exception

OptExceptions ::= Exception*
Exceptions ::= Exception+
Exception ::= MetaComment
Exception ::= BadComment
Exception ::= BlankLine</code></pre>
<p>The terminals in this BNF are</p>
<ul>
<li><p>BadComment -- a comment with any alignment.</p></li>
<li><p>BlankLine -- a line terminated with a newline and otherwise containing only zero or more spaces.</p></li>
<li><p>InterComment -- a comment that starts at the inter-comment column.</p></li>
<li><p>LowerRiser -- a comment that starts one stop past the inter-comment column.</p></li>
<li><p>MetaComment -- a comment that starts at column 1.</p></li>
<li><p>PreComment -- a comment that starts at the pre-comment column.</p></li>
<li><p>Tread -- a comment that starts at the inter-comment column, whose first four characters are colons, and whose fifth character is either a space or a newline.</p></li>
<li><p>UpperRiser -- a comment that starts at the inter-comment column.</p></li>
</ul>
<p>Terminals are ambiguous -- a given line may match more than one terminal. The lexer limits this ambiguity using &quot;priorities&quot;. Each terminal has a numerical priority: 1, 2, 3 or 4. Comments are read as if looked for in numerical order by priority. This is traditional, but has the counter-intuitive effect that the highest priority is the lowest numbered one. These definitions imply that</p>
<ul>
<li><p>No comment is read as a Priority 4 comment if it can be lexed as a Priority 1, 2 or 3 comment.</p></li>
<li><p>No comment is read as a Priority 3 comment if it can be lexed as a Priority 1 or 2 comment.</p></li>
<li><p>No comment is read as a Priority 2 comment if it can be lexed as a Priority 1 comment.</p></li>
</ul>
<p>Comments with the same priority are treated as if they were read simultaneously. This means that it remains possible for terminals to be ambiguous -- that is, one line can be read as two different terminals. In these cases the BNF grammar ensures that only one of the terminals will be used.</p>
<p>Priority 1 comments are InterComment, LowerRiser, Tread, and UpperRiser. The priority 2 comment is PreComment. The priority 3 comment is MetaComment. Priority 4 comments are BadComment and BlankLine.</p>
<h1 id="appendix-futures">Appendix: Futures</h1>
<h2 id="eliminate-the-details">Eliminate the details</h2>
<p>The scheme for currying in this document was derived by attempting to minimize discrepancies with the <code>arvo/</code> corpus, while being conservative. While this allows practices actually exemplified in the <code>arvo/</code> corpus, it bans many practices which fit elegantly with the general principles of these conventions.</p>
<p>It would produce a simpler and more elegant standard if the rules in the &quot;Details&quot; section were eliminated, except for those describing the Sail and Udon statements.</p>
<h2 id="free-currying">&quot;Free&quot; currying</h2>
<p>Another disadvantage of attempting to minimize discrepancies with the <code>arvo/</code> corpus, is that it introduced a large number of &quot;special cases&quot; into the currying conventions.</p>
<p>It might make more sense to adopt a &quot;free&quot; convention for when currying is allowed. Here &quot;free&quot; is used in the mathematical sense, to mean &quot;free of arbitrary assumptions&quot;.</p>
<p>Here is a &quot;free&quot; definition of when currying occurs;</p>
<ul>
<li><p>The source and target runes of a curried text block should be Hoon statement runes on the same line.</p></li>
<li><p>A tall running should not start or end inside a text block.</p></li>
<li><p>A tall jogging should not start or end inside a text block.</p></li>
<li><p>A battery should not start or end inside a text block.</p></li>
<li><p>An arm of a battery should not start or end inside a text block.</p></li>
<li><p>A curried text block should be as long as possible, consistent with the above rules.</p></li>
</ul>
<p>This &quot;free&quot; definition is both more liberal and more restrictive than these conventions given in the &quot;Details&quot; section. The &quot;Details&quot; conventions followed the <code>arvo/</code> corpus in allowing battery arms to be curried, while the free definition bans this practice. On the other hand, the &quot;Details&quot; conventions restricted currying to the sources and targets actually exemplified in the <code>arvo/</code> corpus, while this free definition allows source-target pairs for which no example exists in the corpus.</p>
<h2 id="post-comments">Post-comments</h2>
<p>Currently vertical gaps allow pre-comment and inter-comments. In the <code>arvo/</code> corpus, post-comments also seem to occur. Further, in sequences, the vertical gap before a terminating boundary digraph seems to include post-comments and inter-comments, but not pre-comments. Symmetrically, the vertical gap preceding a sequence seems never to include post-comments.</p>
</body>
</html>
