<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Hoon whitespace standards</title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<div id="header">
<h1 class="title">Hoon whitespace standards</h1>
</div>
<div id="TOC">
<ul>
<li><a href="#about-this-document">About this document</a></li>
<li><a href="#terminology">Terminology</a><ul>
<li><a href="#deontology">Deontology</a></li>
<li><a href="#hoon-source-files">Hoon source files</a></li>
<li><a href="#hoon-statements">Hoon statements</a></li>
<li><a href="#runes">Runes</a></li>
<li><a href="#hoon-expressions">Hoon expressions</a></li>
<li><a href="#horizontal-alignment">Horizontal Alignment</a></li>
<li><a href="#joined-and-split">Joined and split</a></li>
<li><a href="#pseudo-joins">Pseudo-joins</a></li>
<li><a href="#reanchoring">Reanchoring</a><ul>
<li><a href="#reanchor-offset">Reanchor offset</a></li>
<li><a href="#first-example">First example</a></li>
<li><a href="#second-example">Second example</a></li>
</ul></li>
<li><a href="#header-and-inline-comments">Header and inline comments</a></li>
<li><a href="#staircase-comments">Staircase comments</a></li>
<li><a href="#vertical-gaps">Vertical Gaps</a></li>
<li><a href="#types-of-tall-hoons">Types of tall hoons</a></li>
</ul></li>
<li><a href="#top-level-whitespace">Top-level whitespace</a></li>
<li><a href="#backdented-hoons">Backdented hoons</a><ul>
<li><a href="#chaining-backdented-hoons">Chaining backdented hoons</a></li>
<li><a href="#split-hints">Split hints</a></li>
</ul></li>
<li><a href="#running-hoons">Running hoons</a><ul>
<li><a href="#running-hoons-1">0-running hoons</a><ul>
<li><a href="#joined-0-running-hoons">Joined 0-running hoons</a></li>
<li><a href="#split-0-running-hoons">Split 0-running hoons</a></li>
</ul></li>
<li><a href="#running-hoons-2">1-running hoons</a><ul>
<li><a href="#joined-1-running-hoons">Joined 1-running hoons</a></li>
<li><a href="#split-1-running-hoons">Split 1-running hoons</a></li>
</ul></li>
<li><a href="#runnings">Runnings</a><ul>
<li><a href="#runstep-inter-line-alignment">Runstep inter-line alignment</a></li>
<li><a href="#running-inherited-inter-line-alignment">Running-inherited inter-line alignment</a></li>
</ul></li>
</ul></li>
<li><a href="#jogging-hoons">Jogging hoons</a><ul>
<li><a href="#joggings">Joggings</a><ul>
<li><a href="#chess-sidedness">Chess-sidedness</a></li>
</ul></li>
<li><a href="#jogs">Jogs</a><ul>
<li><a href="#joined-jogs">Joined jogs</a></li>
<li><a href="#split-jogs">Split jogs</a></li>
</ul></li>
<li><a href="#criss-cross-lines">Criss-cross lines</a></li>
<li><a href="#jogging-hoons-1">1-jogging hoons</a><ul>
<li><a href="#kingside-1-jogging-hoons">Kingside 1-jogging hoons</a></li>
<li><a href="#queenside-1-jogging-hoons">Queenside 1-jogging hoons</a></li>
</ul></li>
<li><a href="#jogging-hoons-2">2-jogging hoons</a><ul>
<li><a href="#kingside-head-joined-2-jogging-hoons">Kingside head-joined 2-jogging hoons</a></li>
<li><a href="#kingside-head-split-2-jogging-hoons">Kingside head-split 2-jogging hoons</a></li>
<li><a href="#queenside-head-joined-2-jogging-hoons">Queenside head-joined 2-jogging hoons</a></li>
<li><a href="#queenside-head-split-2-jogging-hoons">Queenside head-split 2-jogging hoons</a></li>
</ul></li>
<li><a href="#jogging-1-hoons">Jogging-1 hoons</a></li>
<li><a href="#sigcen">SIGCEN</a></li>
</ul></li>
<li><a href="#battery-hoons">Battery hoons</a><ul>
<li><a href="#batteries">Batteries</a></li>
<li><a href="#barcen">BARCEN</a><ul>
<li><a href="#split-barcen">Split BARCEN</a></li>
<li><a href="#joined-barcen">Joined BARCEN</a></li>
</ul></li>
<li><a href="#barcab">BARCAB</a></li>
<li><a href="#barket">BARKET</a></li>
</ul></li>
<li><a href="#ford-hoons">Ford hoons</a><ul>
<li><a href="#ford-1-hoons">Ford-1 hoons</a></li>
<li><a href="#ford-hoof-hoons">Ford hoof hoons</a></li>
<li><a href="#sequence-ford-hoons">0-sequence Ford hoons</a></li>
<li><a href="#ford-hoon-sequence">Ford hoon sequence</a></li>
<li><a href="#ford-2-hoons">Ford-2 hoons</a></li>
<li><a href="#fascom">FASCOM</a><ul>
<li><a href="#joined-fascom">Joined FASCOM</a></li>
<li><a href="#kingside-split-fascom">Kingside split FASCOM</a></li>
<li><a href="#queenside-split-fascom">Queenside split FASCOM</a></li>
<li><a href="#fascom-element-sequence">FASCOM element sequence</a></li>
</ul></li>
<li><a href="#fastis">FASTIS</a></li>
</ul></li>
<li><a href="#sail">Sail</a><ul>
<li><a href="#sail-1-fixed-runes">Sail 1-fixed runes</a></li>
<li><a href="#semtis">SEMTIS</a></li>
<li><a href="#tagged-sail-statements">Tagged sail statements</a></li>
<li><a href="#sail-attributes">Sail attributes</a></li>
</ul></li>
<li><a href="#udon">Udon</a></li>
<li><a href="#selgap">SELGAP</a></li>
<li><a href="#appendix-non-standard-code">Appendix: Non-standard code</a><ul>
<li><a href="#chess-sidedness-1">Chess-sidedness</a></li>
<li><a href="#jogging-body-column">Jogging body column</a></li>
<li><a href="#inter-line-alignment">Inter-line alignment</a></li>
</ul></li>
<li><a href="#appendix-formal-definition-of-vertical-gap-body">Appendix: Formal definition of &quot;vertical gap body&quot;</a></li>
<li><a href="#appendix-formal-definition-of-anchor-column">Appendix: Formal definition of &quot;anchor column&quot;</a></li>
<li><a href="#appendix-reanchoring-futures">Appendix: Reanchoring futures</a></li>
</ul>
</div>
<h1 id="about-this-document">About this document</h1>
<p>This document is intended to describe the use of whitespace by Hoon to the level and to the degree of precision necessary for <code>hoonfmt</code> and <code>hoonlint</code>. This document therefore only deals with conventions for Hoon expressions that contain gaps. These are</p>
<ul>
<li><p>tall Hoon expressions; and</p></li>
<li><p>SELGAP, a special case.</p></li>
</ul>
<p>Whitespace in other Hoon expressions is always an &quot;ace&quot; -- a single space. For these Hoon expressions in which all whitespace is an ace, there is no latitude in the use of whitespace, and no need for conventions of the kind described in this document.</p>
<h1 id="terminology">Terminology</h1>
<h2 id="deontology">Deontology</h2>
<p>In this document, we say &quot;<code>X</code> should be <code>Y</code>&quot;, if <code>X</code> must be <code>Y</code> in order to meet the standard described in this document. Code or practices that do not meet this standard we will call <strong>non-standard</strong>. One pragmatic consequence of non-standard code is that it may draw warnings from <code>hoonlint</code>. It is expected that, even in carefully written Hoon code, non-standard practices will occur.</p>
<p>In this document, we say &quot;<code>X</code> must be <code>Y</code>&quot;, if <code>X</code> must be <code>Y</code> in both standard and non-standard code. This would be the case, for example, if X is Y as a matter of definition, or if X is Y due to a logical or a mathematical equivalence.</p>
<h2 id="hoon-source-files">Hoon source files</h2>
<p>This document applies to Hoon source files. A Hoon source file is divided into newline-terminated lines each of which contains 1 or more characters. The 1-based offset of a character in its line is its <strong>column location</strong>. The 1-based line number of a character is its <strong>line location</strong>. Line location is often abbreviated to <strong>line</strong>, and column location is often abbreviated to <strong>column</strong>.</p>
<p>To avoid confusion, in this document &quot;column&quot; is always used to mean the column location of a character within a line, as defined above. When we discuss other 2-dimensional grids, we use the terms &quot;row&quot; for position on the vertical axis, and &quot;silo&quot; for position on the horizontal axis.</p>
<p>For orthogonality with columns and lines, row and silo numbers are 1-based. There will be several definitions of &quot;row&quot; and &quot;silo&quot;, and we will give specifics in the context where they are used.</p>
<p>When we say that &quot;sequence <code>S[0], S[1] ... S[n]</code> is <strong>siloed</strong> beginning at silo <code>x</code>&quot;, we mean that, for <code>0 &lt;= i &lt;= n</code>, <code>S[i]</code> goes into silo <code>i+x</code>. When we say that &quot;sequence <code>S[0], S[1] ... S[n]</code> is <strong>siloed</strong>&quot;, we mean that element <code>S[i]</code> goes into silo <code>i+1</code>.</p>
<p>A <strong>whitespace character</strong> is either an ASCII space or a newline. A <strong>whitespace boundary</strong> is one of the following:</p>
<ul>
<li><p>The start of the Hoon source file.</p></li>
<li><p>The end of the Hoon source file.</p></li>
<li><p>A location between a whitespace character and a non-whitespace character.</p></li>
</ul>
<p>Note that a whitespace boundary is not a column location. Instead it is a location immediately before a column location; immediately after a column location; or both.</p>
<p>A character block is a lexically contiguous sequence of one or more characters. A whitespace block is a character block that contains only whitespace characters and occurs between two whitespace boundaries. An <strong>ace</strong> is a whitespace block that contains a single ASCII space. A <strong>gap</strong> is any whitespace block that is not an ace.</p>
<p>A <strong>horizontal gap</strong> is a gap that contains only ASCII spaces. A <strong>vertical gap</strong> is a gap that contains at least one newline. All gaps are either horizontal or vertical.</p>
<p>A <strong>text block</strong> is a character block</p>
<ul>
<li><p>that begins at a whitespace boundary;</p></li>
<li><p>whose first character is a non-whitespace character;</p></li>
<li><p>that ends at a whitespace boundary; and</p></li>
<li><p>whose last character is a non-whitespace character.</p></li>
</ul>
<p>Note that text blocks may contain whitespace characters. We often refer to a text block simply as a <strong>text</strong>.</p>
<p>The column location at which <code>x</code> starts will sometimes be written as <code>Column(x)</code>, where <code>x</code> designates some text in a Hoon source file. The line location at which <code>x</code> starts will sometimes be written as <code>Line(x)</code>. When we say &quot;the column location of <code>x</code>&quot;, we mean <code>Column(x)</code>.</p>
<p>We say &quot;column <code>C</code> is aligned <code>N</code> characters after column <code>D</code>&quot; if and only if <code>C = D + N</code>. We say &quot;column <code>C</code> is aligned at column <code>D</code>&quot; if and only if <code>C = D</code>. We say &quot;column <code>C</code> is aligned <code>N</code> characters before column <code>D</code>&quot; if and only if <code>C = D - N</code>.</p>
<p>When we speak of text blocks being aligned relative to columns or relative to other text blocks, we are refering to the column location of the text blocks. For example, if we say &quot;Text X is aligned N characters after text Y&quot;, we mean that <code>Column(X) = Column(Y) + N</code>.</p>
<p>Often we express distance between columns in stops instead of characters. A <strong>stop</strong> is two characters.</p>
<p>Many alignments are with respect to an <strong>anchor column</strong>. Usually, the anchor column is the rune column, but there are important exceptions, which will be described below.</p>
<h2 id="hoon-statements">Hoon statements</h2>
<p>A hoon source file contains one or more hoon <strong>statements</strong>. The hoon statements are separated by whitespace. Optionally, the first hoon statement may be preceded by whitespace. Also optionally, the last hoon statement may be followed by whitespace.</p>
<p>A hoon <strong>statement</strong> is a text block which compiles to a single AST node. We sometimes refer to a hoon statement as a &quot;hoon&quot;, but strictly speaking, the &quot;hoon statement&quot; is the text block before parsing, and the &quot;hoon&quot; is the AST produced by parsing.</p>
<h2 id="runes">Runes</h2>
<p>In this document, <strong>rune</strong> is used in a somewhat different sense than in most Hoon documents. In most Hoon documents, &quot;rune&quot; means a digraph which acts as the keyword at the beginning of a hoon statement. In this document, we will refer to those as the &quot;statement runes&quot;.</p>
<p>In this document, &quot;rune&quot; will mean either</p>
<ul>
<li><p>a statement rune; or</p></li>
<li><p>an arm marker digraph: one of LUSLUS (<code>++</code>), LUSHEP (<code>+-</code>), or LUSTIS (<code>+=</code>).</p></li>
</ul>
<p>Note that not all special-character digraphs are runes. In this document, HEPHEP (<code>--</code>) or TISTIS (<code>==</code>) will be called <strong>terminators</strong>, and they are not runes. The comment-marking digraph <code>::</code>, is also not a rune. Comments, including the digraphs that begin them, are considered whitespace, and nothing in whitespace is considered a rune.</p>
<h2 id="hoon-expressions">Hoon expressions</h2>
<p>A tall <strong>rune expression</strong> is a tall Hoon expression whose &quot;keyword&quot; is a rune.</p>
<p>Let <code>r</code> be the rune digraph of a rune expression. The <strong>rune line</strong> of <code>r</code> is <code>Line(r)</code>. The <strong>rune column</strong> of <code>r</code> is <code>Column(r)</code>.</p>
<p>A tall rune expression consists of the initial rune followed by zero or more subexpressions, called <strong>runechildren</strong>. The <strong>arity</strong> of a rune expression is the number of its runechildren. In the tall Hoon expressions being considered in this document, the rune is separated from its first runechild, and consecutive runechildren are separated from each other, by gaps.</p>
<p>Let <code>r</code> be a rune. We sometimes write the Hoon expression that begins with <code>r</code> as <code>Hoon(r)</code>. If <code>h</code> is a Hoon, we can write its rune as <code>Rune(h)</code>. Then</p>
<pre><code>   Line(Hoon(r)) == Line(r)
   Column(Hoon(r)) == Column(r)</code></pre>
<p>Let <code>h</code> be a rune expression. We sometimes write the Hoon expression that is the syntactic parent of <code>h</code> as <code>Parent(h)</code>.</p>
<p>A hoon properly contains a text block if it includes the entire text block, but is not identical to it. A hoon &quot;directly contains&quot; a text block if it properly contains the text block, and no other properly contained text block of the hoon is a Hoon subexpression that properly contains that text block.</p>
<h2 id="horizontal-alignment">Horizontal Alignment</h2>
<p>Three kinds of horizontal alignment will be of special interest:</p>
<ul>
<li><p><strong>Tight</strong>: A text block is tightly aligned if is immediately preceded by, and separated from, another text block by a horizontal one-stop gap. Note that, by this definition, the first text block on a line can never be tightly aligned.</p></li>
<li><p><strong>Backdented</strong>: Hoon's standard alignment, described in detail below.</p></li>
<li><p><strong>Inter-line</strong>: Inter-line alignment aligns the non-whitespace lexeme with non-whitespace lexemes on associated lines. Which non-whitespace lexeme is aligned with which, and which lines are considered &quot;associated&quot; varies depending on the syntactic context. Inter-line alignment is described in detail in the sections describing the syntaxes where it is allowed.</p></li>
</ul>
<h2 id="joined-and-split">Joined and split</h2>
<p>For many Hoon expressions, the pattern of the standard whitespace conventions depends on whether a specific gap in that Hoon expression is horizontal or vertical. If the pattern-decisive gap is horizontal, the conventions follow a &quot;joined&quot; pattern. If the pattern-decisive gap is vertical, the conventions follow a &quot;split&quot; pattern. The specific conventions will be specified below, with each syntax.</p>
<h2 id="pseudo-joins">Pseudo-joins</h2>
<p>It is sometimes convenient to have a vertical pattern-decisive gap, but to otherwise follow the &quot;joined&quot; syntax pattern. For example, the programmer may find &quot;joined&quot; syntax appropriate, but want to insert a comment in the pattern-decisive gap. In these situations, it is useful to have a form of the vertical gap that, for pattern-decisive purposes, is treated as if it were a horizontal gap. Such a gap is called a <strong>pseudo-join</strong>.</p>
<p>Let <code>J</code> be a <strong>join column</strong>. A text is <strong>pseudo-joined</strong> at <code>J</code> if and only if every line of it, except the last line, has a comment aligned at <code>J</code>. Note that this implies that the first, partial, line of the gap must contain a comment aligned at <code>J</code>.</p>
<p>Visually, the pseudo-join's comments look like &quot;place holders&quot; for the text that follows the pseudo-join.</p>
<p>Intuitively, a pseudo-join is equivalent to a horizontal gap if the text that follows both of them is aligned at the same column location. More formally, Let <code>file1</code> be a Hoon source file. Let <code>J</code> be the join column of a pseudo-join in <code>file1</code>. Construct another Hoon source file, <code>file2</code>, by lexically replacing the pseudo-join with a horizontal gap. Call that horizontal gap, <code>G</code>. Let <code>H</code> be the column location immediately after <code>G</code> in <code>file2</code>. The pseudo-join and the horizontal gap are <strong>equivalent</strong> if and only if <code>J == H</code>.</p>
<h2 id="reanchoring">Reanchoring</h2>
<p>Reanchoring is a method of conserving indentation. We call the original rune, the one that is to be reanchored, the <strong>reanchored rune</strong>.</p>
<p>Typically, a rune is its own &quot;anchor&quot; rune for indentation purposes, but Hoon takes advantage of some opportunities to move the anchor column closer to the left margin. Not all runes participate in reanchoring. Which do, and which do not, are specified in the individual cases.</p>
<p>The anchor column depends on two things: the column location of anchor rune, and the &quot;reanchor offset&quot;. The <strong>anchor rune</strong> is a rune on the same line as the reanchored rune. The anchor rune is either the same as the reanchored rune, or is a rune closer to the left margin.</p>
<h3 id="reanchor-offset">Reanchor offset</h3>
<p>The reanchor offset is an adjustment necessary to make reanchor indentation &quot;look right&quot; in Hoon terms. It makes the reanchored indentation look and act like normal backdented indentation. The need for it is not obvious from the definition but, visually, if the reanchor offset were not applied, things would &quot;look wrong&quot;.</p>
<p>Call the text block that starts at the column location of the anchor rune, and that ends immediately after the last character of the reanchored rune, the &quot;reanchor block&quot;. Reanchoring may be thought of treating the &quot;reanchor block&quot; as if it were a single rune. This can be thought of a sort of &quot;currying&quot;, and the reanchor block can be thought of as a curried rune.</p>
<p>Some runechildren of the curried runes are included in the reanchor block, and they therefore must be included in the currying. Those runechildren not in the reanchor block are &quot;left over&quot;, and are not included in the currying.</p>
<p>The &quot;left over&quot; runechildren can be thought of as the runechildren of the curried rune. For it to look as if the children of this curried rune were backdented normally, the whitespace conventions must account for curried versus &quot;left over&quot; runechildren.</p>
<p>Intuitively, if not all the runechildren of a curried rune are on the rune line, not only are some of the runechildren &quot;left over&quot;, the appropriate amount of indentation is also &quot;left over&quot;. This &quot;left over&quot; indentation of each rune is the &quot;per-rune offset&quot; of that rune.</p>
<p>The <strong>reanchor offset</strong> of <code>r</code> is the sum of all the per-rune offsets between the <code>a</code> and <code>r</code>, including <code>a</code> but not including <code>r</code>. <code>r</code>'s per-rune offset is not included in the calculation of the reanchor offset, because the rune-children of <code>r</code> are not curried. In effect, all of <code>r</code>'s children are &quot;left over&quot;.</p>
<p>There will be examples below that show the calculation of per-rune-offsets in a reanchoring context. But, for a first example, it will be easiest to see how the definition of the per-rune-offset applies to a simple backdented hoon. Call the following Hoon fragment, &quot;Actual&quot;:</p>
<pre><code>:^  a  b  c
d</code></pre>
<p>What is the per-rune offset of the COLKET (<code>:^</code>) expression in &quot;Actual&quot;? Its last runechild on the same line is the text <code>c</code>. Let us rewrite &quot;Actual&quot;, moving the <code>c</code> to the next line and aligning according to the conventions of this document. Our rewritten fragment, which we will call &quot;What if?&quot;, follows:</p>
<pre><code>:^  a  b
  c
d</code></pre>
<p>Standard alignment for the 3rd COLKET runechild placed it at column 3 in the &quot;What if?&quot; example. Column 3 is two characters after the alignment of the COLKET rune, at column 1. Therefore the per-rune-offset of the COLKET in &quot;Actual&quot; is two: <code>3 - 1 == 2</code>. A formal definition of &quot;anchor column&quot; is given in an appendix.</p>
<h3 id="first-example">First example</h3>
<p><em>From <code>arvo/sys/vane/ford.hoon</code>, lines 1916-1920:</em></p>
<pre><code>        :+  %depends  %|  :~
          definitions+[%&amp; deh]
          listeners+[%&amp; sup]
          waiting+[%&amp; out]
        ==</code></pre>
<p>The rune line is line 1916, and the rune is COLSIG (<code>:~</code>). The anchor rune is the COLLUS (<code>:+</code>). COLLUS is 3-fixed, but all three of its runechildren are on the rune line, so the per-rune offset is 0. The anchor column is defined to be the anchor rune column plus the reanchor offset, so that in this case, the anchor column is the same as the anchor rune column.</p>
<p>COLSIG is 0-running, and normal COLSIG indentation aligns the runsteps one stop after the anchor column, and puts the final TISTIS at the anchor column. This is exactly what we see.</p>
<h3 id="second-example">Second example</h3>
<p><em>From <code>arvo/lib/hood/kiln.hoon</code>, lines 346-356:</em></p>
<pre><code>    =/  request-data  :~
        [0 [0 8.080] 0 &#39;localhost&#39; ~]
        ::  associate 0 as the anonymous ship, which is the ++add result.
        [[0 (scot %p (add our ^~((bex 64))))] ~ ~]
        &#39;not-yet-implemented&#39;
        `&#39;en-US,en;q=0.9&#39;
        `.127.0.0.1
      ==
    =/  monies/coin  [%many ~[[%blob request-data] [%$ ~.n 0]]]
    =/  request/silk:ford  [%bake %urb monies [our %home [%da now]] /web]
    (emit `card`[%exec /kiln/prime/cache our `[[our %home [%da now]] request]])</code></pre>
<p>Here the rune line is line 346, the rune is again COLSIG, and it reanchors at TISFAS (<code>=/</code>). TISFAS is 3-fixed, and 2 of its runechildren are on the rune line, so that the per-rune offset of the TISFAS is that of its 2nd runechild -- one stop. The anchor column is therefore one stop after the anchor rune column.</p>
<p>COLSIG again is 0-running, so that its runsteps should be aligned one stop after the anchor column, which is two stops after the TISFAS column. By the same logic, the TISTIS should be aligned at the anchor column -- one stop after the TISFAS. This is what we see in the example. The last three lines of the example are the last runechild of the TISFAS.</p>
<h2 id="header-and-inline-comments">Header and inline comments</h2>
<p>Comments count as whitespace. A comment is a <strong>header comment</strong> if it is on a line by itself. If a comment is not a header comment, it is a <strong>rightside</strong> comment. A rightside comment is a <strong>margin comment</strong> if it begins at or after column 57, or immediately after a horizontal gap of 20 or more characters. All margin comments should start at column 57. A rightside comment is an <strong>inline comment</strong> if it is not a margin comment.</p>
<p>In standard code, header comments are</p>
<ul>
<li><p>pre-comments or inter-comments, as determined by their hoon;</p></li>
<li><p>part of a staircase; or</p></li>
<li><p>meta-comments.</p></li>
</ul>
<p>We say that a comment belongs to a hoon if that hoon directly contains the gap that lexically contains that comment. We say a hoon is the hoon of a comment if the comment belongs to that hoon.</p>
<p>Meta-comments start at column 1. Since, depending on their hoon, inter-comments may also start at column 1, only the programmer's intent determines whether a given header comment is an inter-comment or a meta-comment.</p>
<p>Pre-comments, inter-comments and staircases are structural comments. The contents of structural comments should usually be appropriate for the syntactic context of the code in which the structural comment occurs.</p>
<p>Meta-comments are not structural comments, and their content may be anything. A frequent use for meta-comments is to &quot;comment out&quot; Hoon code.</p>
<h2 id="staircase-comments">Staircase comments</h2>
<p>Informally, staircase comments take the form</p>
<pre><code>::
::
::::
  ::
  ::</code></pre>
<p>More formally, a staircase comment consists of an <strong>upper riser</strong>, a <strong>tread</strong>, and a <strong>lower riser</strong>. The upper riser is a sequence of normal comment lines, aligned at the inter-comment column. (The inter-comment column location varies, depending on the syntax which contains the comment.) The tread is four colons, aligned at the inter-comment column and followed by a whitespace character. The lower riser is a sequence of normal comment lines, aligned at the column one stop greater than the inter-comment column. A still more formal definition of a staircase is given in an appendix.</p>
<h2 id="vertical-gaps">Vertical Gaps</h2>
<p>When we state that a vertical gap has comments at one location, we mean that the gap's inter-comment column location is the stated column location, and that the gap's pre-comment column location is not defined. When we state that a vertical gap has comments at two locations, we mean that the gap's inter-comment column location is the first location mentioned, and that the gap's pre-comment column location is the second location mentioned.</p>
<p>For example, when we write</p>
<blockquote>
<p>A vertical gap, with comments at the the anchor column and the jog base column</p>
</blockquote>
<p>we mean that the inter-comment location of the vertical gap is the anchor column, and the pre-comment-location is the &quot;jog base column&quot;. If instead we write</p>
<blockquote>
<p>A vertical gap, with comments at the the anchor column.</p>
</blockquote>
<p>then we mean that the inter-comment location of the vertical gap is the anchor column, and the pre-comment-location is not defined.</p>
<p>In describing a vertical gap's comment locations, we may specify them explicitly as column locations, or implicitly, as alignments with a text block. If column location is expressed implicitly via a text block, the implicit location is the start column location of the text block.</p>
<p>A vertical gap contains</p>
<ul>
<li><p>A newline-terminated partial line preamble. This preamble may be of length 1 -- that is, it may be just the newline.</p></li>
<li><p>A body of zero or more full newline-terminated lines, all of them header comments or (in the case of non-standard code) blank lines.</p></li>
<li><p>A partial line postamble. This is never newline-terminated, and may be zero-length.</p></li>
</ul>
<p>Informally, the body of a standard vertical gap follows these conventions:</p>
<ul>
<li><p>A vertical gap may contain an &quot;inter-part&quot;, a &quot;pre-part&quot;, or both.</p></li>
<li><p>If both an inter-part and a pre-part are present, the inter-part must precede the pre-part.</p></li>
<li><p>The inter-part is a non-empty sequence of inter-comments and staircases.</p></li>
<li><p>A pre-part is a non-empty sequence of pre-comments.</p></li>
<li><p>Meta-comments may be inserted anywhere in either the pre-part or the inter-part.</p></li>
<li><p>A comment is not regarded as a meta-comment if it can be parsed as structural comment.</p></li>
</ul>
<p>A more formal description of a vertical gap body is given in an appendix.</p>
<h2 id="types-of-tall-hoons">Types of tall hoons</h2>
<p>Every tall hoon falls into one of 5 disjoint classes: backdented, running, jogging, battery or irregular.</p>
<ul>
<li><p>A tall hoon is a <strong>battery hoon</strong> if it contains an runechild that uses the battery syntax.</p></li>
<li><p>A tall hoon is a <strong>running hoon</strong> if it contains an runechild that uses the running syntax.</p></li>
<li><p>A tall hoon is a <strong>jogging hoon</strong> if it contains an runechild that uses the jogging syntax.</p></li>
<li><p>A tall hoon is a <strong>backdented hoon</strong> if it contains a fixed number of gap-separated runechildren, and none of them follow the running, jogging or battery syntax.</p></li>
<li><p>SELGAP is a tall <strong>irregular hoon</strong>. (Most irregular hoons do not contain a gap.)</p></li>
</ul>
<h1 id="top-level-whitespace">Top-level whitespace</h1>
<p>We call a hoon statement not contained by another hoon statement, a <strong>top-level</strong> hoon statement. A Hoon source file is a sequence of top-level hoon statements. All top-level hoon statements should start at column 1. Successive top-level hoon statements should be separated by a vertical gap with comments at column location 1.</p>
<p>The first top-level hoon statement may be preceded by a vertical gap, called the top-level leader. Comments in the top-level leader should be at column location 1. The top-level leader is a special-case of a vertical gap -- it contains a body and a zero-length postamble, but no preamble.</p>
<p>The last top-level hoon statement may be follows by a vertical gap, called the top-level trailer. Comments in the top-level trailer should be at column location 1. The top-level trailer is a special-case of a vertical gap -- it contains a body and a preamble, but no postamble.</p>
<h1 id="backdented-hoons">Backdented hoons</h1>
<p>The flagship Hoon whitespace strategy is backdenting. Variations on the idea of backdenting appear throughout, but the archetypal case of backdenting is its use in backdented hoons. Here is a example of a backdented 4-ary hoon:</p>
<p><em>From <code>arvo/sys/hoon.hoon</code>, 6752-6755:</em></p>
<pre><code>        :^    %wtcl
            [%dtts [%rock %$ |] [%$ axe]]
          [%rock %f |]
        [%rock %f &amp;]
</code></pre>
<p>A backdented hoon of arity 3 or more should be joined. A backdented hoon of arity 2 or less should be split.</p>
<p>The first runechild of a joined backdented hoon should be on the same line as the rune, separated by a horizontal gap. Subsequent runechildren of a joined backdented hoon should be separated by a vertical gap.</p>
<p>The first runechild of a split backdented hoon should be separated from the rune by a vertical gap. Subsequent runechildren of a joined backdented hoon should also be separated by a vertical gap.</p>
<p>In an backdented <code>n</code>-arity hoon, the <code>m</code>'th runechild should be aligned <code>n-m</code> stops after than the anchor column. For example, in an 3-runechild hoon, the first runechild should be aligned 2 stops after than the anchor column; a second runechild should be aligned 1 stop after than the anchor column; and the third runechild be aligned at the anchor column.</p>
<p>This implies that, regardless of the number of runechildren in a backdented hoon,</p>
<ul>
<li><p>the last runechild should be aligned at the anchor column;</p></li>
<li><p>every runechild before the last should be aligned one stop after than the runechild that follows it.</p></li>
<li><p>every runechild after the first should have be aligned one stop before the runechild that precedes it.</p></li>
</ul>
<p>In the vertical gaps that belong directly to backdented hoons, comments should be aligned with the runechild immediately following the gap.</p>
<h2 id="chaining-backdented-hoons">Chaining backdented hoons</h2>
<p>As a special case, a runechild of an backdented hoon may have an inter-line alignment, based on its <strong>silo</strong> and <strong>chain</strong>. Intuitively, if two runechildren are in the same silo of the same chain, they should have the same inter-line alignment.</p>
<p><em>From <code>arvo/sys/zuse.hoon</code>, lines 2950-2959:</em></p>
<pre><code>     ::
     ::  make acru cores
     ::
     =/  ali      (pit:nu:crub 512 (shaz &#39;Alice&#39;))
     =/  ali-pub  (com:nu:crub pub:ex.ali)
     =/  bob      (pit:nu:crub 512 (shaz &#39;Robert&#39;))
     =/  bob-pub  (com:nu:crub pub:ex.bob)
     ::
     ::  alice signs and encrypts a symmetric key to bob
     ::</code></pre>
<p>More formally, a chain is a sequence of backdented hoons that obeys the following rules:</p>
<ul>
<li><p>Every hoon except the first is the last runechild of the previous hoon in the sequence.</p></li>
<li><p>Every tall rune is either</p>
<ul>
<li><p>a &quot;row-initial&quot; tall rune, which should be aligned at the first hoon in the sequence, or;</p></li>
<li><p>a &quot;joined&quot; tall rune, that is, another tall rune on the same line as an initial rune.</p></li>
</ul></li>
<li><p>The sequence is maximal. That is, no chain is a sub-sequence of a longer chain.</p></li>
</ul>
<p>For the purposes of chain inter-line alignment, we define row and silo as follows: Each row-initial rune starts a new row. For each row, the tall runes and their runechildren on the initial rune's line, taken in lexical order and recursively, are siloed.</p>
<p>A runechild that itself is a tall rune expression is never a silo element -- instead it is broken out into its rune and runechildren, and these become silo elements in that row. A row may contain multiple lines, but runes and runechildren not on the first line of the row are not added as silo elements, and therefore are not used in determining inter-line alignment.</p>
<p>This implies that</p>
<ul>
<li><p>Every row-initial rune is in silo 0,</p></li>
<li><p>Every tall rune is a separate silo element.</p></li>
<li><p>Every runechild of a tall rune is a separate silo element, unless it is itself a tall rune expression.</p></li>
<li><p>For chained inter-line alignment, the row and silo grid may be &quot;ragged&quot;, so that some rows do not have elements in every silo.</p></li>
<li><p>Every row in a chain starts with a rune, but not every rune starts a new row.</p></li>
<li><p>A silo may contain both runes and runechildren.</p></li>
</ul>
<p><em>From <code>arvo/sys/hoon.hoon</code>, lines 1572-1575:</em></p>
<pre><code>    =|  b/(set _?&gt;(?=(^ a) p.n.a))
    |-  ^+  b
    ?~  a   b
    $(a r.a, b $(a l.a, b (~(put in b) p.n.a)))</code></pre>
<p>In the above example, the chain contains 3 rows. (The 3rd and 4th lines are both in the last row.) There are 3 silos, but the rows are &quot;ragged&quot;, so that nothing in the first row is in the 3rd silo. In all 3 rows, the 2nd silo is tightly aligned, as is the 3rd silo in the 2nd row.</p>
<p>The 3rd silo of the 3rd row is inter-line aligned. The <code>b</code> in the 3rd row comes after a gap of 3 spaces, but this follows the standard set forth in this document because it aligns with the <code>b</code> of the 2nd row, at column location 13.</p>
<p>Note that the 2nd silo includes both runechild and a rune. This is an example of a &quot;joined&quot; hoon. In a chained hoon sequence, when the row starts with a unary rune, joined hoons can be convenient.</p>
<h2 id="split-hints">Split hints</h2>
<p><em>From <code>sys/vane/clay.hoon</code>, lines 4022-4228:</em></p>
<pre><code>    ~&gt;  %slog.
        :^  0  %rose  [&quot; &quot; &quot;[&quot; &quot;]&quot;]
        :^    leaf+&quot;initial merge failed&quot;
            leaf+&quot;my most sincere apologies&quot;
          &gt;p.p.p.+.q.hin&lt;
        q.p.p.+.q.hin
    [~ ..^$]</code></pre>
<p>The first runechild of SIGGAL (<code>~&lt;</code>) and SIGGAR (<code>~&gt;</code>) is a &quot;hint&quot;. Hints have a &quot;split&quot; form.</p>
<p>A split form hint begins with its &quot;head&quot;: a symbol name (in <code>%name</code> form) followed by a DOT. The rest of the hint is its &quot;tail&quot;.</p>
<p>The tail of a split form hint should be separated from its head by a vertical gap, with comments aligned with the head. The tail should also be aligned with the head.</p>
<h1 id="running-hoons">Running hoons</h1>
<p>A running runechild is more often called simply a <strong>running</strong>. Currently, no hoon contains more than one running.</p>
<p>A running hoon may contain a runechild before the running. That runechild is called the <strong>head</strong> of the running hoon.</p>
<p>There are two kinds of running hoons:</p>
<ul>
<li>A <strong>0-running</strong> has no head. The current 0-running rules are BUCCEN (<code>$%</code>), BUCCOL (<code>$:</code>), BUCWUT (<code>$?</code>), COLSIG (<code>:~</code>), COLTAR (<code>:*</code>), TISSIG (<code>=~</code>), WUTBAR (<code>?|</code>), and WUTPAM (<code>?&amp;</code>).</li>
</ul>
<!-- TISSIG is very problematic.
It's a 0-running implemented (why?) in hoon.hoon as a 1-running.
-->
<ul>
<li>A <strong>1-running</strong> has a head. The current 1-running rules are CENCOL (<code>%:</code>), DOTKET (<code>.^</code>), SEMCOL (<code>;:</code>), SEMSIG (<code>;~</code>).</li>
</ul>
<h2 id="running-hoons-1">0-running hoons</h2>
<p>0-running hoons may be either split or joined.</p>
<h3 id="joined-0-running-hoons">Joined 0-running hoons</h3>
<p><em>From <code>arvo/sys/zuse.hoon</code>, lines 2399-2402:</em></p>
<pre><code>              :~  [b er]
                  [b pk]
                  [(met 0 m) m]
              ==</code></pre>
<p>A joined 0-running hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>A running where</p>
<ul>
<li><p>runstep lines are aligned two stops after the anchor column;</p></li>
<li><p>the inter-column of the vertical gaps is aligned at the anchor column; and</p></li>
<li><p>the pre-column of the vertical gaps is aligned at the runstep lines.</p></li>
</ul></li>
<li><p>A vertical gap, whose inter-column is the anchor column, and whose pre-column is aligned at the runstep lines.</p></li>
<li><p>A TISTIS aligned at the anchor column.</p></li>
</ul>
<h3 id="split-0-running-hoons">Split 0-running hoons</h3>
<p>This example is the beginning and end of a long split 0-running hoon.</p>
<p><em>From <code>avro/sur/twitter.hoon</code>, lines 84-194:</em></p>
<pre><code>    :~
      [  {$mentions $~}                %get   /statuses/mentions-timeline  ]
      [  {$posts-by sd $~}             %get   /statuses/user-timeline  ]
      [  {$timeline $~}                %get   /statuses/home-timeline  ]
      [  {$retweets-mine $~}           %get   /statuses/retweets-of-me  ]
:: Lines 89-189 are omitted
      [  {$help-langs $~}              %get   /help/languages  ]
      [  {$help-privacy $~}            %get   /help/privacy  ]
      [  {$help-tos $~}                %get   /help/tos  ]
      [  {$rate-limit-info $~}         %get   /application/rate-limit-status  ]
    ==</code></pre>
<p>A split 0-running hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A vertical gap, with comments at the anchor column, and aligned at the runstep lines.</p></li>
<li><p>A running where runstep lines are aligned one stop after the anchor column. The runstep lines are separated by vertical gaps with comments at the anchor column and aligned with the runstep lines.</p></li>
<li><p>A vertical gap, with comments at the anchor column, and aligned at the runstep lines.</p></li>
<li><p>A TISTIS aligned at the anchor column.</p></li>
</ul>
<!-- TODO: check all uses of runeColumn to be sure that
     anchor column is not what is intended -->
<h2 id="running-hoons-2">1-running hoons</h2>
<p>1-running hoon statements do not reanchor. 1-running hoons can be joined or split.</p>
<h3 id="joined-1-running-hoons">Joined 1-running hoons</h3>
<p><em>From <code>arvo/sys/hoon.hoon</code>, lines 4853-4855:</em></p>
<pre><code>             ;~  less  soz
               (ifix [soq soq] (boss 256 (more gon qit)))
             ==</code></pre>
<p>A joined 1-running hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>The first runstep line.</p></li>
<li><p>A vertical gap with comments at the anchor column, and aligned one stop after the anchor column.</p></li>
<li><p>The remainder of the running, where runstep lines are aligned one stop after the anchor column. The runsteps lines should be separated by vertical gaps with comments at the anchor column and aligned one stop after the anchor column.</p></li>
<li><p>A vertical gap with comments at the anchor column and aligned one stop after the anchor column.</p></li>
<li><p>A TISTIS aligned at the anchor column.</p></li>
</ul>
<h3 id="split-1-running-hoons">Split 1-running hoons</h3>
<p><em>From <code>arvo/sys/zuse.hoon</code>, lines 4048-4051:</em></p>
<pre><code>      ;~  pose
        (cold &amp; (jest &#39;true&#39;))
        (cold | (jest &#39;false&#39;))
      ==</code></pre>
<p>A split 1-running hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, whose inter-column is the anchor column, and whose pre-column is aligned one stop after the anchor column.</p></li>
<li><p>A running where</p>
<ul>
<li><p>runstep lines are aligned one stop after the anchor column;</p></li>
<li><p>the inter-column of the vertical gaps is aligned at the anchor column; and</p></li>
<li><p>the pre-column of the vertical gaps is aligned one stop after the anchor column.</p></li>
</ul></li>
<li><p>A vertical gap, whose inter-column is the anchor column, and whose pre-column is aligned one stop after the the anchor column.</p></li>
<li><p>A TISTIS aligned at the anchor column.</p></li>
</ul>
<h2 id="runnings">Runnings</h2>
<p>A running contains one or more <strong>runstep lines</strong>. Runstep lines should be aligned at the <strong>runstep base column</strong>, with exceptions. The runstep base column location for each running hoon, and the exceptions, if any, are stated in the specification of the running hoon that directly contains the running.</p>
<p>Within a runstep line, the runsteps should be tightly aligned, or they should follow runstep inter-line alignment, as described next.</p>
<h3 id="runstep-inter-line-alignment">Runstep inter-line alignment</h3>
<p>In a row of runsteps, runsteps after the first may have inter-line alignment. Within a running, the inter-line alignment column of runsteps is determined by their silo.</p>
<p><em>From <code>sys/zuse.hoon</code>, lines 4892-4905:</em></p>
<pre><code>        :~  ~2015.6.30..23.59.59   ~2012.6.30..23.59.59
            ~2008.12.31..23.59.58  ~2005.12.31..23.59.57
            ~1998.12.31..23.59.56  ~1997.6.30..23.59.55
            ~1995.12.31..23.59.54  ~1994.6.30..23.59.53
            ~1993.6.30..23.59.52   ~1992.6.30..23.59.51
            ~1990.12.31..23.59.50  ~1989.12.31..23.59.49
            ~1987.12.31..23.59.48  ~1985.6.30..23.59.47
            ~1983.6.30..23.59.46   ~1982.6.30..23.59.45
            ~1981.6.30..23.59.44   ~1979.12.31..23.59.43
            ~1978.12.31..23.59.42  ~1977.12.31..23.59.41
            ~1976.12.31..23.59.40  ~1975.12.31..23.59.39
            ~1974.12.31..23.59.38  ~1973.12.31..23.59.37
            ~1972.12.31..23.59.36  ~1972.6.30..23.59.35
        ==</code></pre>
<p>Each runstep line is a row. For each row, the runsteps, in lexical order, are siloed.</p>
<h3 id="running-inherited-inter-line-alignment">Running-inherited inter-line alignment</h3>
<p>If a runstep is a backdented hoon, the runechildren of a backdented hoon may have a <strong>running-inherited</strong> inter-line alignment. Within a running, the running-inherited inter-line alignment of a runechild is determined by the silo of the runechild. A running should not have both running-inherited and runestep alignment.</p>
<p><em>From `sys/hoon.hoon', lines 5303-5308:</em></p>
<pre><code>    :~  :-  [&#39;a&#39; &#39;z&#39;]  (cook |=(a/@ta [%$ %tas a]) sym)
        :-  [&#39;0&#39; &#39;9&#39;]  (stag %$ bisk)
        :-  &#39;-&#39;        (stag %$ tash)
        :-  &#39;.&#39;        ;~(pfix dot perd)
        :-  &#39;~&#39;        ;~(pfix sig ;~(pose twid (easy [%$ %n 0])))
    ==</code></pre>
<p>Each backdented hoon is a row. For each row, The sequence composed of the rune of the hoon, followed by its runechildren in lexical order, is siloed.</p>
<p>Note that if a backdented hoon is a runestep, it may have both a running-inherited inter-line alignment and a chained inter-line alignment. If a backdented hoon does have both inter-line alignments, they should be consistent. That is, for every silo, the column location of that silo according to running-inherited alignment should be identical to the column location of that silo according to chained alignment.</p>
<h1 id="jogging-hoons">Jogging hoons</h1>
<p>A jogging runechild is more often called simply a <strong>jogging</strong>. (Currently all hoons contains at most one jogging.)</p>
<p>In addition to the jogging, a jogging hoon may contain other runechildren, either before or after the jogging. An runechild after the jogging is called a <strong>tail</strong>. If there is one runechild before the jogging, it is called the <strong>head</strong> of the jogging hoon. If there are two runechildren before the jogging, they are called, in order, the <strong>head</strong> and <strong>subhead</strong> of the jogging.</p>
<p>There are currently four kinds of jogging hoon:</p>
<ul>
<li><p>The current 1-jogging rules are CENTIS (<code>%=</code>), CENCAB (<code>%_</code>) and WUTHEP (<code>?-</code>). A 1-jogging has one head and no tail.</p></li>
<li><p>The current 2-jogging rules are CENTAR (<code>%*</code>) and WUTLUS (<code>?+</code>). A 2-jogging has a head and a subhead but no tail.</p></li>
<li><p>The current jogging-1 rule is TISCOL (<code>=:</code>). A jogging-1 has a tail and no head.</p></li>
<li><p>The current 2-jogging-1 statement is SIGCEN (<code>~%</code>). A 2-jogging-1 statement has a head, a subhead, and a tail.</p></li>
</ul>
<h2 id="joggings">Joggings</h2>
<p>A jogging is a gap-separated sequence of one or more jogs. Every <strong>jog</strong> contains a <strong>jog head</strong>, followed by a gap and a <strong>jog body</strong>. Note that it is important to distinguish between the head of a jogging hoon, defined above, and the head of a jog.</p>
<h3 id="chess-sidedness">Chess-sidedness</h3>
<p>Jogs, joggings and jogging hoons have <strong>chess-sidedness</strong>. Chess-sidedness is always either kingside and queenside. Informally, <strong>kingside</strong> means the indentation has a left-side bias; and <strong>queenside</strong> means that the indentation has a right-side bias. The effect of sidedness on indentation will be specified more precisely in the descriptions of jogs and of the individual types of jogging hoon. The general idea is that chess-sidedness stays consistent within a hoon.</p>
<h2 id="jogs">Jogs</h2>
<p>The column location of a jog is that of its head. A jog is <strong>joined</strong> if its head is on the same line as its body. Otherwise, a jog is <strong>multiline</strong>. As explained below, a multiline jog may be either <strong>pseudo-joined</strong> or <strong>split</strong>.</p>
<p>Jogs are either kingside or queenside. In standard code, the sidedness of a jog determines the alignment of split jogs.</p>
<p>The base column location of a jog depends on the jogging hoon that it belongs to. It is specified in the description of the different kinds of jogging hoon.</p>
<h3 id="joined-jogs">Joined jogs</h3>
<p>A joined jog may be either <strong>inter-line aligned</strong> or <strong>ragged</strong>. A joined jog is ragged if its body is aligned one stop after its head. Otherwise, a joined jog is considered inter-line aligned.</p>
<p>All inter-line aligned jogging should be aligned at the jogging body column. With each jogging, at most one column should be designated as the <strong>jogging body column</strong> of the jogging.</p>
<p>A jog may also be pseudo-joined. The pseudo-join of pseudo-joined jog should be equivalent to the one of the horizontal gaps that a joined jog is allowed according to this standard.</p>
<h3 id="split-jogs">Split jogs</h3>
<p>The gap of split jog should be a vertical gap with comments at the column location of the jog body. The standard column location of the body of a split jog varies according to the sidedness of the jog.</p>
<ul>
<li><p>The column location of the body of a split kingside jog should be aligned one stop <strong>after</strong> the jog's head.</p></li>
<li><p>The column location of the body of a split queenside jog should be aligned one stop <strong>before</strong> the jog's head.</p></li>
</ul>
<h2 id="criss-cross-lines">Criss-cross lines</h2>
<p><em>From <code>arvo/sys/zuse.hoon</code>, lines 906-918 :</em></p>
<pre><code>          $:  $:  our/ship                              ::  host
                  src/ship                              ::  guest
                  dap/term                              ::  agent
              ==                                        ::
              $:  wex/boat                              ::  outgoing subs
                  sup/bitt                              ::  incoming subs
              ==                                        ::
              $:  ost/bone                              ::  opaque cause
                  act/@ud                               ::  change number
                  eny/@uvJ                              ::  entropy
                  now/@da                               ::  current time
                  byk/beak                              ::  load source
          ==  ==                                        ::</code></pre>
<p>Recall that a terminator is a HEPHEP (<code>--</code>) or a TISTIS (<code>==</code>). Successive terminators may occur on the same line, as part of a <strong>criss-cross terminator line</strong>. A terminator is in a criss-cross line does not have to be aligned correctly, if some other terminator with the required alignment &quot;stands in&quot; for it.</p>
<p>Note, however, that since every terminator on the line requires some terminator to be aligned according to this standard, all of the terminators end up with an alignment requirement. In the example above, the two terminators on line 918 stand in for each other, and each imposes an alignment requirement on the other.</p>
<p>Criss-cross lines are so called because if you draw a line from each terminator on the criss-cross line to the rune that it matches syntactically, you end up with a set of lines, each of which crosses all the others.</p>
<p>Only one kind of terminator should appear in a criss-cross line. Every character in a criss-cross line should be part of a terminator, or part of a gap.</p>
<h2 id="jogging-hoons-1">1-jogging hoons</h2>
<p>Every 1-jogging hoon is either kingside or queenside. 1-jogging hoons reanchor at KETLUS (<code>^+</code>).</p>
<h3 id="kingside-1-jogging-hoons">Kingside 1-jogging hoons</h3>
<p><em>From <code>arvo/sys/hoon.hoon</code>, lines 6330-6334:</em></p>
<pre><code>  ?-  pex
    {$1 $0}  yom
    {$1 $1}  woq
    *        [%6 pex yom woq]
  ==</code></pre>
<p>A kingside 1-jogging hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, with comments at the the anchor column and the jog base column.</p></li>
<li><p>A kingside jogging. The jog base column should be one stop after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the the anchor column and the jog base column.</p></li>
<li><p>A TISTIS, starting at the anchor column.</p></li>
</ul>
<h3 id="queenside-1-jogging-hoons">Queenside 1-jogging hoons</h3>
<p><em>From <code>arvo/sys/hoon.hoon</code>, lines 6305-6309:</em></p>
<pre><code>  ?-    nug
      {$0 *}   p.nug
      {$10 *}  $(nug q.nug)
      *        ~_(leaf+&quot;cove&quot; !!)
  ==</code></pre>
<p>A queenside 1-jogging hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A 2-stop horizontal gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, with comments at the the anchor column and the jog base column.</p></li>
<li><p>A queenside jogging. The jog base column should be two stops after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the the anchor column and the jog base column.</p></li>
<li><p>A TISTIS, aligned at the anchor column.</p></li>
</ul>
<h2 id="jogging-hoons-2">2-jogging hoons</h2>
<p>If the head and subhead of a 2-jogging hoon are on the same line, the 2-jogging hoon is called <strong>head-joined</strong>. If the head and subhead of a 2-jogging hoon are on different lines, the 2-jogging hoon is called <strong>head-split</strong>.</p>
<p>2-jogging hoon statements do not reanchor.</p>
<h3 id="kingside-head-joined-2-jogging-hoons">Kingside head-joined 2-jogging hoons</h3>
<p><em>From <code>arvo/sys/hoon.hoon</code>, lines 6583-6586:</em></p>
<pre><code>      ?+  p.mod  [%rock %$ 0]
        $cell  [[%rock %$ 0] [%rock %$ 0]]
        $void  [%zpzp ~]
      ==</code></pre>
<p>A head-joined kingside 2-jogging hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>Its subhead.</p></li>
<li><p>A vertical gap, with comments at the the anchor column and the jog base column.</p></li>
<li><p>A kingside jogging. The jog base column should be one stop after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the the anchor column and the jog base column.</p></li>
<li><p>A TISTIS, aligned at the anchor column.</p></li>
</ul>
<h3 id="kingside-head-split-2-jogging-hoons">Kingside head-split 2-jogging hoons</h3>
<p><em>From <code>hoons/arvo/app/hall.hoon</code>, lines 1772-1781:</em></p>
<pre><code>    ?+  -.det
      =&lt;  sa-done
      %.  det
      =+  (fall (~(get by stories) nom) *story)
      ~(sa-change sa nom -)
    ::
      $new      (da-create nom +.det)
      $bear     ~&amp;(%unexpected-unsplit-bear +&gt;)
      $remove   (da-delete nom)
    ==</code></pre>
<p>A head-split kingside 2-jogging hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>Its subhead, aligned one stop before the head.</p></li>
<li><p>A vertical gap, with comments at the the anchor column and the jog base column.</p></li>
<li><p>A kingside jogging. The jog base column should be one stop after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the the anchor column and the jog base column.</p></li>
<li><p>A TISTIS, aligned at the anchor column.</p></li>
</ul>
<h3 id="queenside-head-joined-2-jogging-hoons">Queenside head-joined 2-jogging hoons</h3>
<p><em>From <code>arvo/sys/vane/ames.hoon</code>, lines 1568-1575:</em></p>
<pre><code>      ?+    lot  ~
          [$$ %ud @]
        (perm p.why u.hun q.p.lot [syd t.tyl])
      ::
          [$$ %da @]
        ?.  =(now q.p.lot)  ~
        (temp p.why u.hun [syd t.tyl])
      ==</code></pre>
<p>A head-joined queenside 2-jogging hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A 2-stop horizontal gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>Its subhead.</p></li>
<li><p>A vertical gap, with comments at the the anchor column and the jog base column.</p></li>
<li><p>A queenside jogging. The jog base column should be two stops after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the the anchor column and the jog base column.</p></li>
<li><p>A TISTIS, aligned at the anchor column.</p></li>
</ul>
<h3 id="queenside-head-split-2-jogging-hoons">Queenside head-split 2-jogging hoons</h3>
<p><em>Adapted from <code>arvo/lib/hood/kiln.hoon</code>, starting at line 582:</em></p>
<pre><code>    ?+    gem
        (spam leaf+&quot;strange auto&quot; &gt;gem&lt; ~)
    ::
        $init
      =+  :-  &quot;auto merge failed on strategy %init&quot;
          &quot;I&#39;m out of ideas&quot;
      lose:(spam leaf+-&lt; leaf+-&gt; [&gt;p.p.are&lt; q.p.are])
    ::
    ==</code></pre>
<p>A head-split queenside 2-jogging hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A 2-stop horizontal gap.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, with comments at the the anchor column.</p></li>
<li><p>Its subhead, aligned one stop before the head.</p></li>
<li><p>A vertical gap, with comments at the the anchor column and the jog base column.</p></li>
<li><p>A queenside jogging. The jog base column should be two stops after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the the anchor column and the jog base column.</p></li>
<li><p>A TISTIS, aligned at the anchor column.</p></li>
</ul>
<h2 id="jogging-1-hoons">Jogging-1 hoons</h2>
<!-- "Split" form addressed in Github issue #31" -->
<p>Jogging-1 hoons do not reanchor.</p>
<p><em>From <code>arvo/sys/hoon.hoon</code>, lines 9720-9727:</em></p>
<pre><code>          =:  hos  ~
              wec  [~ ~ ~]
            ==
          ::  descend into cell
          ::
          :+  %cell
            dext(sut p.sut, ref (peek(sut ref) %free 2))
          dext(sut q.sut, ref (peek(sut ref) %free 3))</code></pre>
<p>Every jogging-1 hoon is considered kingside. A jogging-1 hoon should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>A kingside jogging. The jog base column should be two stops after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the the anchor column and the jog base column.</p></li>
<li><p>A TISTIS, aligned one stop after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the the anchor column.</p></li>
<li><p>A tail, aligned at the anchor column.</p></li>
</ul>
<h2 id="sigcen">SIGCEN</h2>
<p>SIGCEN does not reanchor.</p>
<p><em>From <code>sys/hoon.hoon</code>, lines 3684-6234:</em></p>
<pre><code>~%    %qua
    +
  ==
    %mute  mute
    %show  show
  ==
|%
:: Lines 3691-6233 are omitted
--</code></pre>
<p>SIGCEN statements can be treated either a special form of a jogging hoon, or as a 4-fixed hoon with, optionally, an unusual 3rd runechild.</p>
<p>SIGCEN, except for its 3rd runechild, is treated as an ordinary 4-ary backdented hoon. SIGCEN's 3rd runechild may be either <code>~</code> or a jogging bounded by TISTIS lines. The jogging is always kingside and elements are never split.</p>
<p>The initial TISTIS should be backdented appropriately for a third runechild. The final TISTIS should be aligned with the initial TISTIS.</p>
<p>The initial TISTIS should be followed by a vertical gap with comments aligned with the TISTIS and with the jogs. The final TISTIS should be followed by a vertical gap with comments aligned with the TISTIS and with the jogs.</p>
<p>The jog head should be aligned one stop after the initial TISTIS. The jog body should be tightly aligned, or inter-line aligned with other bodies in the formula list. Successive formulas should be separated by a vertical gap with comments aligned with the jogs.</p>
<h1 id="battery-hoons">Battery hoons</h1>
<p>The battery hoons are BARCAB, BARCEN and BARKET.</p>
<h2 id="batteries">Batteries</h2>
<p>The arms of a battery should all align at the same column, called the <strong>base column</strong> of the battery. The arms should be separated by vertical gaps, where the inter-column is the base column, and the pre-column is two stops after the base column. The base column of the battery is specified below, in the description of each battery hoon. Arms may be joined or split.</p>
<p>A battery arm reanchors at BARCEN.</p>
<p><em>From sieve_k example, line 6:</em></p>
<pre><code>++  abet  (sort (~(tap in fed)) lth)</code></pre>
<p>A joined arm consists of, in lexical order:</p>
<ul>
<li><p>A arm marker.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>The arm head.</p></li>
<li><p>A one-stop horizontal gap, or an equivalent pseudo-join.</p></li>
<li><p>The arm body.</p></li>
</ul>
<p><em>From sieve_k example, lines 7-12:</em></p>
<pre><code>++  main
  =+  fac=2
  |-  ^+  ..main
  ?:  (gth (mul fac fac) top)
    ..main
  $(fac +(fac), ..main (reap fac))</code></pre>
<p>A split arm consists of, in lexical order:</p>
<ul>
<li><p>A arm marker.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>The arm head.</p></li>
<li><p>A vertical gap, with comments at the base column,</p></li>
<li><p>The arm body, aligned one stop after the anchor column.</p></li>
</ul>
<h2 id="barcen">BARCEN</h2>
<p>BARCEN may reanchor at KETBAR or KETWUT. It may be joined or split.</p>
<h3 id="split-barcen">Split BARCEN</h3>
<p><em>From the sieve_k example:</em></p>
<pre><code>|%
++  abet  (sort (~(tap in fed)) lth)
++  main
  =+  fac=2
  |-  ^+  ..main
  ?:  (gth (mul fac fac) top)
    ..main
  $(fac +(fac), ..main (reap fac))
::
++  reap
  |=  fac=@
  =+  cot=(mul 2 fac)
  |-  ^+  ..reap
  ?:  (gth cot top)
    ..reap
  $(cot (add cot fac), fed (~(del in fed) cot))
--</code></pre>
<p>A split BARCEN should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A battery whose base column is the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A HEPHEP, aligned at the anchor column.</p></li>
</ul>
<h3 id="joined-barcen">Joined BARCEN</h3>
<p><em>From <code>arvo/sys/zuse.hoon</code>, lines 176-181:</em></p>
<pre><code>      |%  ++  seal  |~({a/pass b/@ c/@} *@)             ::  encrypt to a
          ++  sign  |~({a/@ b/@} *@)                    ::  certify as us
          ++  sure  |~({a/@ b/@} *(unit @))             ::  authenticate from us
          ++  tear  |~  {a/pass b/@}                    ::  accept from a
                    *(unit {p/@ q/@})                   ::
      --  ::as                                          ::</code></pre>
<p>A joined BARCEN should consist of, in lexical order:</p>
<ul>
<li><p>Its rune.</p></li>
<li><p>A one stop horizontal gap.</p></li>
<li><p>A battery whose base column is two stops after anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A HEPHEP, aligned at the anchor column.</p></li>
</ul>
<h2 id="barcab">BARCAB</h2>
<p>BARCAB runes do not reanchor.</p>
<p><em>From <code>sys/vane/jael.hoon</code>, lines 697-827:</em></p>
<pre><code>  |_  pig/safe
  ::                                                    ::  ++delete:up
  ++  delete                                            ::  delete right
    |=  ryt/rite
    ^-  safe
:: Lines 701-820 omitted
  ::
  ++  update                                            ::  arbitrary change
    |=  del/bump
    ^-  safe
    (splice(pig (remove les.del)) mor.del)
  --</code></pre>
<p>A BARCAB should consist of, in lexical order:</p>
<ul>
<li><p>Its rune</p></li>
<li><p>A one stop horizontal gap, or an equivalent pseudo-join.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, with comments at the anchor column, and one stop after the anchor column.</p></li>
<li><p>A battery, whose base column location should be the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column, and one stop after the anchor column.</p></li>
<li><p>A HEPHEP, aligned at the anchor column.</p></li>
</ul>
<h2 id="barket">BARKET</h2>
<p>BARKET runes do not reanchor.</p>
<p><em>From <code>arvo/sys/zuse.hoon</code>, lines 3975-4025:</em></p>
<pre><code>    |^  |=(val/json (apex val &quot;&quot;))
    ::                                                  ::  ++apex:en-json:html
    ++  apex
      |=  {val/json rez/tape}
      ^-  tape
:: Lines 3980-4015 omitted
    ::                                                  ::  ++jesc:en-json:html
    ++  jesc                                            ::  escaped
      =+  utf=|=(a/@ [&#39;\\&#39; &#39;u&#39; ((x-co 4):co a)])
      |=  a/@  ^-  tape
      ?+  a  ?:((gth a 0x1f) [a ~] (utf a))
        $10  &quot;\\n&quot;
        $34  &quot;\\\&quot;&quot;
        $92  &quot;\\\\&quot;
      ==
    --  ::en-json</code></pre>
<p>A BARKET should consist of, in lexical order:</p>
<ul>
<li><p>Its rune</p></li>
<li><p>A one stop horizontal gap, or an equivalent pseudo-join.</p></li>
<li><p>Its head.</p></li>
<li><p>A vertical gap, with comments at the anchor column, and one stop after the anchor column.</p></li>
<li><p>A battery, whose base column location should be the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column, and one stop after the anchor column.</p></li>
<li><p>A HEPHEP, aligned at the anchor column.</p></li>
</ul>
<h1 id="ford-hoons">Ford hoons</h1>
<h2 id="ford-1-hoons">Ford-1 hoons</h2>
<p>The ford-1 hoons are a set of unary ford hoons: FASSIG (<code>/~</code>), FASBUC (<code>/$</code>), FASCAB (<code>/_</code>), FASCEN (<code>/%</code>), FASFAS (<code>//</code>), FASHAX (<code>/#</code>) and FASWUT (<code>/?</code>).</p>
<p><em>From <code>arvo/app/hall.hoon</code>, line 17:</em></p>
<pre><code>          /~  |=({t/telegram:hall bowl:gall} t)</code></pre>
<p><em>From <code>hoons/arvo/mar/rss-xml.hoon</code>, line 6:</em></p>
<pre><code>//  /===/mar/xml  :: alias</code></pre>
<p>A tall ford-1 hoon should consist of, in lexical order:</p>
<ul>
<li><p>The rune.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>The runechild.</p></li>
</ul>
<h2 id="ford-hoof-hoons">Ford hoof hoons</h2>
<p>The ford hoof hoons are FASHEP (<code>/-</code>) and FASLUS (<code>/+</code>).</p>
<p><em>From <code>../hoons/arvo/app/dojo.hoon</code>, line 5:</em></p>
<pre><code>/-  sole, lens                                          ::  console structures</code></pre>
<p><em>From <code>hoons/arvo/mar/twit/feed.hoon</code>, line 6:</em></p>
<pre><code>/+  twitter, httr-to-json, old-zuse</code></pre>
<p>A tall Ford hoof hoon should consist of, in lexical order:</p>
<ul>
<li><p>The rune.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>The runechild.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
</ul>
<h2 id="sequence-ford-hoons">0-sequence Ford hoons</h2>
<p>The 0-sequence Ford hoons are those whose only runechild is a sequence of Forn hoons. FASBAR (<code>/|</code>) and FASDOT (<code>/.</code>) are the 0-sequence Ford hoons. The &quot;0-&quot; prefix is for orthogonality with &quot;0-running&quot; hoons.</p>
<p><em>From <code>hoons/arvo/app/hall.hoon</code>, lines 16-18:</em></p>
<pre><code>      /|  /:  /%/filter  /!noun/
          /~  |=({t/telegram:hall bowl:gall} t)
      ==</code></pre>
<!-- No FASDOT code in the current arvo corpus is standard,
do this is a revised example.
-->
<p><em>Adapted from <code>hoons/arvo/web/pack/css/codemirror-fonts-bootstrap-tree.hoon</code>, lines 6-10:</em></p>
<pre><code>  /.  /:/===/web/lib/css/codemirror:/css/
      /:/===/web/lib/css/fonts:/css/
      /:/===/web/lib/css/bootstrap:/css/
      /:/===/web/tree/main:/css/
  ==</code></pre>
<p>A tall 0-sequence Ford hoon should consist of, in lexical order:</p>
<ul>
<li><p>The rune.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>A sequence of ford hoons.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A TISTIS.</p></li>
</ul>
<h2 id="ford-hoon-sequence">Ford hoon sequence</h2>
<p>A Ford hoon sequence is a sequence of ford hoons. All of the ford hoons should be at the same alignment.</p>
<p>The hoons in the sequence should be separated by vertical gaps. The comments in the vertical gaps should be aligned with the rune of the hoon which directly contains the Ford hoon sequence.</p>
<h2 id="ford-2-hoons">Ford-2 hoons</h2>
<p>The Ford-2 hoons are FASCOL (<code>/:</code>), FASKET (<code>/^</code>), FASPAM (<code>/&amp;</code>), and FASSEM (<code>/;</code>).</p>
<!-- Note FASPAM tall whitespacing in conjectured, based
on parallel with FASKET. --
no examples of tall FASPAM exist in the arvo corpus.
-->
<p><em>From <code>hoons/arvo/app/gmail.hoon</code>, line 21:</em></p>
<pre><code>/=  rfctext  /:  /%/rfc  /txt/</code></pre>
<p><em>From <code>hoons/arvo/app/hall.hoon</code>, lines 15-18:</em></p>
<pre><code>      /^  $-({telegram:hall bowl:gall} telegram:hall)
      /|  /:  /%/filter  /!noun/
          /~  |=({t/telegram:hall bowl:gall} t)
      ==</code></pre>
<p><em>From <code>hoons/arvo/ren/tree/index.hoon</code>, line 7:</em></p>
<pre><code>    /;  (getall:tree /h1/h2/h3/h4/h5/h6)  /tree-elem/</code></pre>
<p>Whitespace conventions for the Ford-2 hoons are the same as those for backdented 2-arity hoons.</p>
<h2 id="fascom">FASCOM</h2>
<!-- FASCOM is not well represented in the arvo
database, and a lot of these rules are extrapolations --
they are not actual examples in the corpus.
The remnants of the two-stop Ford convention in the
corpus make extrapolation from the examples next
to impossible.
I use indentation-conservation heavily as the guideline
for extrapolation.
-->
<h3 id="joined-fascom">Joined FASCOM</h3>
<p>All joined FASCOM's are considered &quot;queenside&quot;.</p>
<p><em>From <code>hoons/arvo/ren/css.hoon</code>, lines 6-8:</em></p>
<pre><code>/,  /web/pack/css  /%   /!css/
    /              /~  !!
==</code></pre>
<p>A tall joined FASCOM hoon should consist of, in lexical order:</p>
<ul>
<li><p>The rune.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>A sequence of FASCOM elements, all of which are aligned with the first one.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A TISTIS.</p></li>
</ul>
<h3 id="kingside-split-fascom">Kingside split FASCOM</h3>
<!-- The split FASCOM examples are based
on the only arvo example of a split FASCOM.
It was anchored and non-standard, and therefore
I have revised it.
-->
<p><em>Adapted from <code>hoons/arvo/ren/tree/elem.hoon</code>, lines 5-8:</em></p>
<pre><code>/,
  /web  /|(/!elem/ /elem/)
  /     /elem/
==</code></pre>
<p>A tall kingside split FASCOM hoon should consist of, in lexical order:</p>
<ul>
<li><p>The rune.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A sequence of FASCOM elements, all of which are aligned one stop after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A TISTIS.</p></li>
</ul>
<h3 id="queenside-split-fascom">Queenside split FASCOM</h3>
<!-- The split FASCOM examples are based
on the only arvo example of a split FASCOM.
It was anchored and non-standard, and therefore
I have revised it.
-->
<p><em>Adapted from <code>hoons/arvo/ren/tree/elem.hoon</code>, lines 5-8:</em></p>
<pre><code>/,
    /web  /|(/!elem/ /elem/)
    /     /elem/
==</code></pre>
<p>A tall queenside split FASCOM hoon should consist of, in lexical order:</p>
<ul>
<li><p>The rune.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A sequence of FASCOM elements, all of which are aligned two stops after the anchor column.</p></li>
<li><p>A vertical gap, with comments at the anchor column.</p></li>
<li><p>A TISTIS.</p></li>
</ul>
<h3 id="fascom-element-sequence">FASCOM element sequence</h3>
<p><em>From <code>hoons/arvo/ren/css.hoon</code>, lines 6-8:</em></p>
<pre><code>/,  /web/pack/css  /%   /!css/
    /              /~  !!
==</code></pre>
<p>A FASCOM element sequence consists of a one or more <strong>FASCOM elements</strong>. The head of all the FASCOM elements should be aligned at the same column. The FASCOM elements should be separated by vertical gaps. Comments in the vertical gaps should be at the anchor column or aligned with the heads of the FASCOM elements.</p>
<p>A FASCOM element is considered joined or split, depending on the gap between the head and the body. If joined, the body of the FASCOM element separated from the head by a one-stop gap, or an equivalent pseudo-join.</p>
<p>If the FASCOM element is split, the body of the FASCOM element should be separated by a vertical gap with comments at the body column. The body of a kingside FASCOM element should be aligned one stop <strong>after</strong> the head of the FASCOM element. The body of a queenside FASCOM element should be aligned one stop <strong>before</strong> the head of the FASCOM element.</p>
<h2 id="fastis">FASTIS</h2>
<pre><code>/=  rfctext  /:  /%/rfc  /txt/</code></pre>
<p>A tall FASTIS hoon should consist of, in lexical order:</p>
<ul>
<li><p>The FASTIS rune.</p></li>
<li><p>A one-stop horizontal gap.</p></li>
<li><p>A runechild.</p></li>
</ul>
<h1 id="sail">Sail</h1>
<p>Sail statements start with a semicolon. Sail statements never participate in reanchoring.</p>
<h2 id="sail-1-fixed-runes">Sail 1-fixed runes</h2>
<p><em>From <code>ren/tree/head.hoon</code>, lines 35-43:</em></p>
<pre><code>    ;*  ?.  nopack.dbg
          :_  ~
          ;link(type &quot;text/css&quot;, rel &quot;stylesheet&quot;, href &quot;/===/web/pack/css/codemirror-fonts-bootstrap-tree.css&quot;);
        ;=
          ;link(type &quot;text/css&quot;, rel &quot;stylesheet&quot;, href &quot;/===/web/lib/css/fonts.css&quot;);
          ;link(type &quot;text/css&quot;, rel &quot;stylesheet&quot;, href &quot;/===/web/lib/css/bootstrap.css&quot;);
          ;link(type &quot;text/css&quot;, rel &quot;stylesheet&quot;, href &quot;/===/web/lib/css/codemirror.css&quot;);
          ;link(type &quot;text/css&quot;, rel &quot;stylesheet&quot;, href &quot;/===/web/tree/main.css&quot;);
        ==</code></pre>
<p>The sail 1-fixed runes are SEMHEP (;-), SEMLUS (;+), SEMTAR (;*), and SEMCEN (;%). They have a single runechild. The rune child should be on the same line as the rune, and should be separated from it by a one-stop horizontal gap.</p>
<h2 id="semtis">SEMTIS</h2>
<p><em>From <code>ren/tree/head.hoon</code>, lines 59-64:</em></p>
<pre><code>        ;=
::           ;script(type &quot;text/javascript&quot;, src &quot;/===/web/lib/js/hoon.js&quot;);
          ;script(type &quot;text/javascript&quot;, src &quot;/===/web/tree/main.js&quot;);
          ;script(type &quot;text/javascript&quot;, src &quot;{?.(aut &quot;&quot; &quot;/~~/~/at&quot;)}&quot;.
                                              &quot;/===/web/lib/js/urb.js&quot;);
        ==</code></pre>
<p>SEMTIS (;=) takes a TISTIS-terminated list of sail statements. It is split or joined, depending on whether the first element of the list is on the same line as the SEMTIS.</p>
<p>If joined, the first element of the list should be tightly aligned. If split, the first elements of the list should be aligned one stop after the SEMTIS, and the first element should be preceded by a vertical gap with comments aligned at the SEMTIS and with the first element.</p>
<p>All subsequent elements should be aligned with the first element. For a joined SEMTIS, this implies that all elements after the first should be aligned two stops after the SEMTIS. For a split SEMTIS, this implies that all elements after the first should be aligned one stop after the SEMTIS.</p>
<p>All elements after the first should be preceded by a vertical gap. Comments should be aligned at the SEMTIS and with the first element.</p>
<p>The TISTIS should be aligned with the SEMTIS. it should be preceded by a vertical gap, with comments aligned at the SEMTIS and with the first element.</p>
<h2 id="tagged-sail-statements">Tagged sail statements</h2>
<p><em>Adapted from <code>web/dojo.hoon</code>, lines 13-27:</em></p>
<pre><code>;module
    =nav_title    &quot;Dojo&quot;
    =nav_no-dpad  &quot;&quot;
    =nav_no-sibs  &quot;&quot;
  ;script(src &quot;//cdnjs.cloudflare.com/ajax/libs/mousetrap/1.4.6/mousetrap.js&quot;);
  ;style:&#39;&#39;&#39;
         #term { width: 100%; }
         #term * { margin: 0px; }
         .module pre { margin-bottom: 0; }
         &#39;&#39;&#39;
  ;div#err;
  ;div#term:&quot;&quot;
  ;script@&quot;/lib/js/sole.js&quot;;
  ;sole(appl &quot;dojo&quot;);
==</code></pre>
<p>Tagged sail statement are always split. The conventions for the sail attributes are described below. All elements should be aligned one stop after the start of the statement. The tagged statement is considered to start at the semicolon which starts the tag that is its keyword.</p>
<p>All elements should be preceded by a vertical gap. Comments in the vertical gaps should be aligned at the start of the statement and with the first element.</p>
<p>The TISTIS should be aligned with the tagged sail statement that it terminates. The TISTIS should be preceded by a vertical gap, with comments aligned with the tagged sail statement, and with the first element.</p>
<h2 id="sail-attributes">Sail attributes</h2>
<p>The sail attribute base column is two stops after start column location of the sail text block. Sail tall attributes should be separated from each other by a vertical gap with comments aligned at the attribute base column. Values in sail attributes should be on the same line as the sail key. The sail attribute values should be tightly aligned, or aligned with each other.</p>
<h1 id="udon">Udon</h1>
<p>Currently, this standard does not address Udon (Unmarkdown) whitespace conventions.</p>
<h1 id="selgap">SELGAP</h1>
<p><em>From <code>arvo/sur/twitter.hoon</code>, line 85:</em></p>
<pre><code>     [  {$mentions $~}                %get   /statuses/mentions-timeline  ]</code></pre>
<p>Whitespace in one-line SELGAP's is free-form -- <code>hoonlint</code> never generates a warning for them.</p>
<p>Only one-line SELGAP's occur in the <code>arvo</code> corpus. If <code>hoonlint</code> encounters a multi-line SELGAP, it issues a &quot;not yet implemented&quot; warning.</p>
<h1 id="appendix-non-standard-code">Appendix: Non-standard code</h1>
<p>By non-standard code, we mean code that does not follow the guidelines of this document. In non-standard code, <code>hoonlint</code> sometimes must decide the &quot;intended&quot; syntax, in order to produce diagnostics that are as helpful as possible. This appendix describes the methods used for deciding what was &quot;intended&quot; in non-standard Hoon code.</p>
<h2 id="chess-sidedness-1">Chess-sidedness</h2>
<p>A jog is considered queenside if it is aligned 2 stops or more after the base column of the jogging. Otherwise, the jog is considered kingside.</p>
<p>The chess-sidedness of a jogging is that of the majority of its jogs. In case of a tie, the jogging is considered to be queenside. The chess-sidedness of a jogging hoon is that of its jogging.</p>
<h2 id="jogging-body-column">Jogging body column</h2>
<p>In non-standard code, the jogging body column of a jogging is considered to be the most common start column of the bodies of the jogging's inter-line aligned jogs. If more than one column is &quot;most common&quot;, the tie is resolved in favor of the body column that is lexically first. If there are no inter-line aligned jogs in a jogging, the jogging body column is undefined.</p>
<h2 id="inter-line-alignment">Inter-line alignment</h2>
<p>&quot;Attached&quot; text blocks are those with tight or backdented alignment. All other text blocks are &quot;floating&quot;. In non-standard code, the column location of the inter-line alignment of a silo of text blocks is the column location most common in the &quot;floating&quot; text blocks.</p>
<p>If two column locations tie in the count of floating text blocks, the tie is broken using the count of total text blocks for that column location. If two column locations tie by total text block count, the tie is broken in favor of the column location that occurs first, lexically.</p>
<p>If there are no floating lexemes, the inter-line alignment column location is irrelevant and undefined. Also, the inter-line alignment column location is undefined unless it also has a total text block count of at least 2 -- in other words an inter-line alignment column location must be the column location of at least two of the text blocks in the silo.</p>
<p>Each silo is examined separately. For each silo, only rows with an element in that silo participate in the calculation.</p>
<p>If a running could have both a runestep alignment, and a running-inherited alignment, the runestep alignment takes precedence. In other words, if a running has runestep alignment, the running-inherited alignment is undefined.</p>
<h1 id="appendix-formal-definition-of-vertical-gap-body">Appendix: Formal definition of &quot;vertical gap body&quot;</h1>
<p>The format of a vertical gap body obeys the BNF</p>
<pre><code>:start ::= gapComments
gapComments ::= OptExceptions Body
gapComments ::= OptExceptions
Body ::= InterPart PrePart
Body ::= InterPart
Body ::= PrePart
InterPart ::= InterComponent
InterPart ::= InterruptedInterComponents
InterPart ::= InterruptedInterComponents InterComponent

InterruptedInterComponents ::= InterruptedInterComponent+
InterruptedInterComponent ::= InterComponent Exceptions
InterComponent ::= Staircases
InterComponent ::= Staircases InterComments
InterComponent ::= InterComments

InterComments ::= InterComment+

Staircases ::= Staircase+
Staircase ::= UpperRisers Tread LowerRisers
UpperRisers ::= UpperRiser+
LowerRisers ::= LowerRiser+

PrePart ::= ProperPreComponent OptPreComponents
ProperPreComponent ::= PreComment
OptPreComponents ::= PreComponent*
PreComponent ::= ProperPreComponent
PreComponent ::= Exception

OptExceptions ::= Exception*
Exceptions ::= Exception+
Exception ::= MetaComment
Exception ::= BadComment
Exception ::= BlankLine</code></pre>
<p>The terminals in this BNF are</p>
<ul>
<li><p>BadComment -- a comment with any alignment.</p></li>
<li><p>BlankLine -- a line terminated with a newline and otherwise containing only zero or more spaces.</p></li>
<li><p>InterComment -- a comment that starts at the inter-comment column.</p></li>
<li><p>LowerRiser -- a comment that starts one stop past the inter-comment column.</p></li>
<li><p>MetaComment -- a comment that starts at column 1.</p></li>
<li><p>PreComment -- a comment that starts at the pre-comment column.</p></li>
<li><p>Tread -- a comment that starts at the inter-comment column, whose first four characters are colons, and whose fifth character is either a space or a newline.</p></li>
<li><p>UpperRiser -- a comment that starts at the inter-comment column.</p></li>
</ul>
<p>Terminals are ambiguous -- a given line may match more than one terminal. The lexer limits this ambiguity using &quot;priorities&quot;. Each terminal has a numerical priority: 1, 2, 3 or 4. Comments are read as if looked for in numerical order by priority. This has the slightly counter-intuitive effect that the highest priority is the lowest numbered one. These definitions imply that</p>
<ul>
<li><p>No comment is read as a Priority 4 comment if it can be lexed as a Priority 1, 2 or 3 comment.</p></li>
<li><p>No comment is read as a Priority 3 comment if it can be lexed as a Priority 1 or 2 comment.</p></li>
<li><p>No comment is read as a Priority 2 comment if it can be lexed as a Priority 1 comment.</p></li>
</ul>
<p>Comments with the same priority are treated as if they were looked for simultaneously. This means that it remains possible for terminals to be ambiguous -- that is, one line can be read as two different terminals. In these cases the BNF grammar ensures that only one of the terminals will be used.</p>
<p>Priority 1 comments are InterComment, LowerRiser, Tread, and UpperRiser. The priority 2 comment is PreComment. The priority 3 comment is MetaComment. Priority 4 comments are BadComment and BlankLine.</p>
<h1 id="appendix-formal-definition-of-anchor-column">Appendix: Formal definition of &quot;anchor column&quot;</h1>
<p>Let <code>r</code> be the reanchored rune. Let <code>a</code> be the anchor rune of <code>r</code>. The anchor column is <code>Column(a) + Offset(r)</code>, where <code>Offset(r)</code> is the reanchor-offset of <code>r</code>. The rest of this definition will be devoted to defining <code>Offset(r)</code>.</p>
<p>We first define <code>PerRuneOff(r)</code>, the per-rune-offset. Let <code>Child(n, r1)</code>, the <code>n</code>'th runechild of a <code>r1</code>, be the last runechild of <code>r1</code> on <code>Line(r1)</code>. Consider a rewrite of Hoon source that</p>
<ul>
<li><p>moves <code>Child(n, r1)</code> to <code>Line(r1)+1</code>,</p></li>
<li><p>adjusts the whitespace as necessary to follow the standard whitespace conventions, and</p></li>
<li><p>is minimal in all other respects.</p></li>
</ul>
<p>Let <code>c2</code> be <code>Child(n, r1)</code> in this rewrite, so that <code>Line(c2) == Line(r1)+1 == Line(Child(n, r1))+1</code>. Then the per-rune offset of <code>r1</code> is <code>PerRuneOff(r1) == Column(c2) - Column(r1)</code>.</p>
<p>Recall that <code>r</code> is the reanchored rune, and that <code>a</code> is the anchor rune of <code>r</code>. We now define a sequence of runes, <code>S</code>, such that</p>
<ul>
<li><p>If <code>a == r</code>, then <code>S</code> is empty.</p></li>
<li><p>Otherwise, <code>S = S[0], S[1] ... S[n]</code>, and we have the following:</p>
<ul>
<li><p><code>S[0] = a</code>.</p></li>
<li><p><code>S[n] = (Rune(Parent(Hoon(r)))</code>.</p></li>
<li><p><code>S[i] = (Rune(Parent(Hoon(S[i+1])))</code>, for all <code>i</code> such that <code>0 &lt;= i &lt; n</code>.</p></li>
</ul></li>
</ul>
<p>Note the following:</p>
<ul>
<li><p>By the above definition, <code>r</code> is never an element of <code>S</code>.</p></li>
<li><p>In the trivial case, where a rune is its own anchor, <code>S</code> is always empty; the reanchor offset is always zero; and the anchor column is always the same as the rune column.</p></li>
<li><p>If <code>S</code> is not empty, it includes <code>a</code> and all the proper syntactic parents of <code>r</code> that are descendants of <code>a</code>.</p></li>
</ul>
<p>We can now finish our definition of anchor column, by defining <code>Offset(r)</code>: <code>Offset(r)</code> is the sum of <code>PerRuneOff(S[i])</code> for all <code>i</code> such that <code>0 &lt;= i &lt;= n</code>.</p>
<h1 id="appendix-reanchoring-futures">Appendix: Reanchoring futures</h1>
<p>The reanchoring in this document is based, first on the examples, and second, on the <code>arvo/</code> corpus. The approach is conservative -- reanchoring is only in this standard if it is exemplified in the <code>arvo/</code> corpus or the examples. Reanchorings which cause inconsistences with the <code>arvo/</code> corpus are accepted as part of this standard, if it seems reasonable to consider the exceptions to be aberrations. But no inconsistencies with the examples are accepted as part of this standard.</p>
<p>In future, it may be best to revise this document to treat more reanchorings as standard than currently.</p>
<p>The <code>arvo/</code> corpus suggests that BARCEN reanchoring at TISGAR should be considered standard, but accepting BARCEN-to-TISGAR reanchoring as standard would make the tic-tac-toe example non-standard.</p>
<p>On the other hand, lines 1323-1326 from <code>sys/vane/ames.hoon</code> suggest that TISGAR resists being an anchoring target:</p>
<pre><code>=&gt;  ^+  .   %=  .
      q.r.neb  (~(put by q.r.neb) q.fud t.fud)
      q.neb    +(q.neb)
    ==</code></pre>
</body>
</html>
